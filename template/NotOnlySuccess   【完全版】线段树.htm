<!DOCTYPE html>
<!-- saved from url=(0062)http://www.notonlysuccess.com/index.php/segment-tree-complete/ -->
<html lang="zh-CN" class="hb-loaded" version="g42dymwpi--nx"><head profile="http://gmpg.org/xfn/11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">


<title>NotOnlySuccess  | 【完全版】线段树</title>

<link rel="stylesheet" type="text/css" media="all" href="./NotOnlySuccess   【完全版】线段树_files/style.css">
<link rel="pingback" href="http://www.notonlysuccess.com/success/xmlrpc.php">
<link rel="pingback" href="http://www.notonlysuccess.com/success/xmlrpc.php">


<link rel="alternate" type="application/rss+xml" title="NotOnlySuccess » Feed" href="http://www.notonlysuccess.com/index.php/feed/">
<link rel="alternate" type="application/rss+xml" title="NotOnlySuccess » 评论Feed" href="http://www.notonlysuccess.com/index.php/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="NotOnlySuccess » 【完全版】线段树评论Feed" href="http://www.notonlysuccess.com/index.php/segment-tree-complete/feed/">
<link rel="stylesheet" id="wp-quicklatex-format-css" href="./NotOnlySuccess   【完全版】线段树_files/quicklatex-format.css" type="text/css" media="all">
<link rel="stylesheet" id="wordpress-popular-posts-css" href="./NotOnlySuccess   【完全版】线段树_files/wpp.css" type="text/css" media="all">
<link rel="stylesheet" id="commentluv_style-css" href="./NotOnlySuccess   【完全版】线段树_files/commentluv.css" type="text/css" media="all">
<link rel="stylesheet" id="codebox-css" href="./NotOnlySuccess   【完全版】线段树_files/codebox.css" type="text/css" media="screen">
<link rel="stylesheet" id="wp-pagenavi-css" href="./NotOnlySuccess   【完全版】线段树_files/pagenavi-css.css" type="text/css" media="all">
<script type="text/javascript" async="" src="./NotOnlySuccess   【完全版】线段树_files/47793"></script><script type="text/javascript" src="./NotOnlySuccess   【完全版】线段树_files/jquery.js"></script><style type="text/css"></style>
<script type="text/javascript" src="./NotOnlySuccess   【完全版】线段树_files/jquery-migrate.min.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var cl_settings = {"name":"author","url":"url","comment":"comment","email":"email","infopanel":null,"default_on":"on","default_on_admin":null,"cl_version":"2.92.1","images":"http:\/\/www.notonlysuccess.com\/success\/wp-content\/plugins\/commentluv\/images\/","api_url":"http:\/\/www.notonlysuccess.com\/success\/wp-admin\/admin-ajax.php","_fetch":"b9b76239d4","_info":"6506100ad6","infoback":"white","infotext":null,"template_insert":"","logged_in":"","refer":"http:\/\/www.notonlysuccess.com\/index.php\/segment-tree-complete\/","no_url_message":"\u8f93\u5165\u7f51\u5740\uff0c\u7136\u540e\u70b9\u51fbCommentLuv\u524d\u7684\u590d\u9009\u6846\u5c31\u53ef\u4ee5\u5206\u4eab\u4f60\u7684\u6700\u65b0\u535a\u5ba2\u6587\u7ae0\u3002","no_http_message":"\u786e\u4fdd\u7f51\u5740\u524d\u9762\u6709 http:\/\/ \u5b57\u6837","no_url_logged_in_message":"\u5728\u63a7\u5236\u677f\u4e2d\u4e2a\u4eba\u8bbe\u7f6e\u9875\u9762\u66f4\u65b0\u4f60\u7684\u7f51\u7ad9\u7684\u8be6\u7ec6\u4fe1\u606f\u3002","no_info_message":"\u627e\u4e0d\u5230\u4fe1\u606f\u6216\u8005\u51fa\u9519\u3002"};
/* ]]> */
</script>
<script type="text/javascript" src="./NotOnlySuccess   【完全版】线段树_files/commentluv.js"></script>
<script type="text/javascript" src="./NotOnlySuccess   【完全版】线段树_files/comment-reply.min.js"></script>
<script type="text/javascript" src="./NotOnlySuccess   【完全版】线段树_files/jquery.hoverIntent.js"></script>
<script type="text/javascript" src="./NotOnlySuccess   【完全版】线段树_files/jquery.cluetip.js"></script>
<script type="text/javascript" src="./NotOnlySuccess   【完全版】线段树_files/behaviours.js"></script>
<script type="text/javascript" src="./NotOnlySuccess   【完全版】线段树_files/codebox.js"></script>
<script type="text/javascript" src="./NotOnlySuccess   【完全版】线段树_files/wp-quicklatex-frontend.js"></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.notonlysuccess.com/success/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.notonlysuccess.com/success/wp-includes/wlwmanifest.xml"> 
<meta name="generator" content="WordPress 3.6.1">
<link rel="canonical" href="./NotOnlySuccess   【完全版】线段树_files/NotOnlySuccess   【完全版】线段树.htm">
<link rel="shortlink" href="http://www.notonlysuccess.com/?p=978">

<link rel="stylesheet" href="./NotOnlySuccess   【完全版】线段树_files/jquery.cluetip.css" type="text/css">
<link rel="stylesheet" href="./NotOnlySuccess   【完全版】线段树_files/popup.css" type="text/css">
<link rel="stylesheet" type="text/css" media="all" href="./NotOnlySuccess   【完全版】线段树_files/weibo.css">
	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
<!-- wp thread comment 1.4.9.4.002 -->
<style type="text/css" media="screen">
.editComment, .editableComment, .textComment{
	display: inline;
}
.comment-childs{
	border: 1px solid #999;
	margin: 5px 2px 2px 4px;
	padding: 4px 2px 2px 4px;
	background-color: white;
}
.chalt{
	background-color: #E2E2E2;
}
#newcomment{
	border:1px dashed #777;width:90%;
}
#newcommentsubmit{
	color:red;
}
.adminreplycomment{
	border:1px dashed #777;
	width:99%;
	margin:4px;
	padding:4px;
}
.mvccls{
	color: #999;
}
			
</style>

<link type="text/css" rel="stylesheet" href="chrome-extension://cpngackimfmofbokmjmljamhdncknpmg/style.css"><script type="text/javascript" charset="utf-8" src="chrome-extension://cpngackimfmofbokmjmljamhdncknpmg/js/page_context.js"></script></head>
<body class="single single-post postid-978 single-format-standard col-2-right fixed title-segment-tree-complete category-acm author-admin browser-chrome" screen_capture_injected="true" huaban_collector_injected="true" style="">

 
 <!-- page -->
 <div id="page">

    <div id="page-ext">

    <!-- header -->
    <div id="header">
      <div class="page-content">
        <div id="site-title" class="clear-block">
          <div id="logo"><a href="http://www.notonlysuccess.com/">NotOnlySuccess</a></div>          <div class="headline">Battle of the Brains</div>        </div>
      </div>

      <div class="shadow-left page-content">
        <div class="shadow-right nav nav-main">
          <div class="menu-menu-pages-container"><ul id="menu-menu-pages" class="menu fadeThis clear-block"><li class="home "><a href="http://www.notonlysuccess.com/" title="Home Page">Home<span class="p"></span></a></li><li class="page-acm_algorithm_list"><a href="http://www.notonlysuccess.com/index.php/acm_algorithm_list/">ACM算法目录<span class="p"></span></a></li><li class="page-about"><a href="http://www.notonlysuccess.com/index.php/about/">留言板<span class="p"></span></a></li></ul></div>        </div>
      </div>

    </div>
    <!-- /header -->

    <!-- main -->
    <div id="main" class="page-content">
      <div id="main-ext" class="clear-block">

  <!-- main content: primary + sidebar(s) -->
  <div id="mask-3" class="clear-block">
    <div id="mask-2">
      <div id="mask-1">

        <!-- primary content -->
        <div id="primary-content">

          
          
          
          <div class="post-links clear-block">
            <div class="alignleft">« <a href="http://www.notonlysuccess.com/index.php/2011world-finals/" rel="prev">精彩不亮丽，起落是无常</a></div>
            <div class="alignright"><a href="http://www.notonlysuccess.com/index.php/alibaba/" rel="next">2011阿里巴巴程序设计公开赛</a> »</div>
          </div>

          <!-- post -->
          <div id="post-978" class="post-978 post type-post status-publish format-standard hentry category-acm primary count-1 odd author-admin first">

                        <h1 class="title">【完全版】线段树</h1>
            
            <div class="post-content clear-block">
             <p>很早前写的那篇线段树专辑至今一直是本博客阅读点击量最大的一片文章,当时觉得挺自豪的,还去pku打广告,但是现在我自己都不太好意思去看那篇文章了,觉得当时的代码风格实在是太丑了,很多线段树的初学者可能就是看着这篇文章来练习的,如果不小心被我培养出了这么糟糕的风格,实在是过意不去,正好过几天又要给集训队讲解线段树,所以决定把这些题目重新写一遍,顺便把近年我接触到的一些新题更新上去~;并且学习了splay等更高级的数据结构后对线段树的体会有更深了一层,线段树的写法也就比以前飘逸,简洁且方便多了.<br>
<span id="more-978"></span></p>
<p>	在代码前先介绍一些我的线段树风格:</p>
<ul>
<li>maxn是题目给的最大区间,而节点数要开4倍,确切的来说节点数要开大于maxn的最小2<sup>x</sup>的两倍</li>
<li>lson和rson分辨表示结点的左儿子和右儿子,由于每次传参数的时候都固定是这几个变量,所以可以用预定于比较方便的表示</li>
<li>以前的写法是另外开两个个数组记录每个结点所表示的区间,其实这个区间不必保存,一边算一边传下去就行,只需要写函数的时候多两个参数,结合lson和rson的预定义可以很方便</li>
<li>PushUP(int rt)是把当前结点的信息更新到父结点</li>
<li>PushDown(int rt)是把当前结点的信息更新给儿子结点</li>
<li>rt表示当前子树的根(root),也就是当前所在的结点</li>
</ul>
<p>整理这些题目后我觉得线段树的题目整体上可以分成以下四个部分:</p>
<ul>
<li>
<span style="color:#ff0000">单点更新</span>:最最基础的线段树,只更新叶子节点,然后把信息用PushUP(int r)这个函数更新上来<p></p>
<ul>
<li>
<a href="http://acm.hdu.edu.cn/showproblem.php?pid=1166">hdu1166 敌兵布阵</a><br>
题意:O(-1)<br>
思路:O(-1)<br>
线段树功能:update:单点增减 query:区间求和<p></p>

<div class="wp_codebox_msgheader wp_codebox_hide active"><span class="right"><sup><a href="http://www.ericbess.com/ericblog/2008/03/03/wp-codebox/#examples" target="_blank" title="WP-CodeBox HowTo?"><span style="color: #99cc00">?</span></a></sup></span><span class="left"><a href="javascript:;" onclick="javascript:showCodeTxt(&#39;p978code1&#39;); return false;">View Code</a> CPP</span><div class="codebox_clear"></div></div><div class="wp_codebox" style="display: none;"><table><tbody><tr id="p9781"><td class="line_numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
</pre></td><td class="code" id="p978code1"><pre class="cpp" style="font-family:monospace;"><span style="color: #339900;">#include &lt;cstdio&gt;</span>
&nbsp;
<span style="color: #339900;">#define lson l , m , rt &lt;&lt; 1</span>
<span style="color: #339900;">#define rson m + 1 , r , rt &lt;&lt; 1 | 1</span>
<span style="color: #0000ff;">const</span> <span style="color: #0000ff;">int</span> maxn <span style="color: #000080;">=</span> <span style="color: #0000dd;">55555</span><span style="color: #008080;">;</span>
<span style="color: #0000ff;">int</span> sum<span style="color: #008000;">[</span>maxn<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">2</span><span style="color: #008000;">]</span><span style="color: #008080;">;</span>
<span style="color: #0000ff;">void</span> PushUP<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> rt<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	sum<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> sum<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000040;">+</span> sum<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #000040;">|</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">void</span> build<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> l,<span style="color: #0000ff;">int</span> r,<span style="color: #0000ff;">int</span> rt<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>l <span style="color: #000080;">==</span> r<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		<span style="color: #0000dd;">scanf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%d"</span>,<span style="color: #000040;">&amp;</span>sum<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">return</span> <span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span>
	<span style="color: #0000ff;">int</span> m <span style="color: #000080;">=</span> <span style="color: #008000;">(</span>l <span style="color: #000040;">+</span> r<span style="color: #008000;">)</span> <span style="color: #000080;">&gt;&gt;</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
	build<span style="color: #008000;">(</span>lson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	build<span style="color: #008000;">(</span>rson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	PushUP<span style="color: #008000;">(</span>rt<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">void</span> update<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> p,<span style="color: #0000ff;">int</span> add,<span style="color: #0000ff;">int</span> l,<span style="color: #0000ff;">int</span> r,<span style="color: #0000ff;">int</span> rt<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>l <span style="color: #000080;">==</span> r<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		sum<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000040;">+</span><span style="color: #000080;">=</span> add<span style="color: #008080;">;</span>
		<span style="color: #0000ff;">return</span> <span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span>
	<span style="color: #0000ff;">int</span> m <span style="color: #000080;">=</span> <span style="color: #008000;">(</span>l <span style="color: #000040;">+</span> r<span style="color: #008000;">)</span> <span style="color: #000080;">&gt;&gt;</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>p <span style="color: #000080;">&lt;=</span> m<span style="color: #008000;">)</span> update<span style="color: #008000;">(</span>p , add , lson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">else</span> update<span style="color: #008000;">(</span>p , add , rson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	PushUP<span style="color: #008000;">(</span>rt<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">int</span> query<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> L,<span style="color: #0000ff;">int</span> R,<span style="color: #0000ff;">int</span> l,<span style="color: #0000ff;">int</span> r,<span style="color: #0000ff;">int</span> rt<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>L <span style="color: #000080;">&lt;=</span> l <span style="color: #000040;">&amp;&amp;</span> r <span style="color: #000080;">&lt;=</span> R<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		<span style="color: #0000ff;">return</span> sum<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span><span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span>
	<span style="color: #0000ff;">int</span> m <span style="color: #000080;">=</span> <span style="color: #008000;">(</span>l <span style="color: #000040;">+</span> r<span style="color: #008000;">)</span> <span style="color: #000080;">&gt;&gt;</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">int</span> ret <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>L <span style="color: #000080;">&lt;=</span> m<span style="color: #008000;">)</span> ret <span style="color: #000040;">+</span><span style="color: #000080;">=</span> query<span style="color: #008000;">(</span>L , R , lson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>R <span style="color: #000080;">&gt;</span> m<span style="color: #008000;">)</span> ret <span style="color: #000040;">+</span><span style="color: #000080;">=</span> query<span style="color: #008000;">(</span>L , R , rson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">return</span> ret<span style="color: #008080;">;</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">int</span> main<span style="color: #008000;">(</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">int</span> T , n<span style="color: #008080;">;</span>
	<span style="color: #0000dd;">scanf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%d"</span>,<span style="color: #000040;">&amp;</span>T<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">for</span> <span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> cas <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span> <span style="color: #008080;">;</span> cas <span style="color: #000080;">&lt;=</span> T <span style="color: #008080;">;</span> cas <span style="color: #000040;">++</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		<span style="color: #0000dd;">printf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"Case %d:<span style="color: #000099; font-weight: bold;">\n</span>"</span>,cas<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		<span style="color: #0000dd;">scanf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%d"</span>,<span style="color: #000040;">&amp;</span>n<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		build<span style="color: #008000;">(</span><span style="color: #0000dd;">1</span> , n , <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">char</span> op<span style="color: #008000;">[</span><span style="color: #0000dd;">10</span><span style="color: #008000;">]</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">while</span> <span style="color: #008000;">(</span><span style="color: #0000dd;">scanf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%s"</span>,op<span style="color: #008000;">)</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
			<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>op<span style="color: #008000;">[</span><span style="color: #0000dd;">0</span><span style="color: #008000;">]</span> <span style="color: #000080;">==</span> <span style="color: #FF0000;">'E'</span><span style="color: #008000;">)</span> <span style="color: #0000ff;">break</span><span style="color: #008080;">;</span>
			<span style="color: #0000ff;">int</span> a , b<span style="color: #008080;">;</span>
			<span style="color: #0000dd;">scanf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%d%d"</span>,<span style="color: #000040;">&amp;</span>a,<span style="color: #000040;">&amp;</span>b<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
			<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>op<span style="color: #008000;">[</span><span style="color: #0000dd;">0</span><span style="color: #008000;">]</span> <span style="color: #000080;">==</span> <span style="color: #FF0000;">'Q'</span><span style="color: #008000;">)</span> <span style="color: #0000dd;">printf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%d<span style="color: #000099; font-weight: bold;">\n</span>"</span>,query<span style="color: #008000;">(</span>a , b , <span style="color: #0000dd;">1</span> , n , <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
			<span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>op<span style="color: #008000;">[</span><span style="color: #0000dd;">0</span><span style="color: #008000;">]</span> <span style="color: #000080;">==</span> <span style="color: #FF0000;">'S'</span><span style="color: #008000;">)</span> update<span style="color: #008000;">(</span>a , <span style="color: #000040;">-</span>b , <span style="color: #0000dd;">1</span> , n , <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
			<span style="color: #0000ff;">else</span> update<span style="color: #008000;">(</span>a , b , <span style="color: #0000dd;">1</span> , n , <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		<span style="color: #008000;">}</span>
	<span style="color: #008000;">}</span>
	<span style="color: #0000ff;">return</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span></pre></td></tr></tbody></table></div>

</li>
<li>
	<a href="http://acm.hdu.edu.cn/showproblem.php?pid=1754">hdu1754 I Hate It</a><br>
题意:O(-1)<br>
思路:O(-1)<br>
线段树功能:update:单点替换 query:区间最值<p></p>

<div class="wp_codebox_msgheader wp_codebox_hide active"><span class="right"><sup><a href="http://www.ericbess.com/ericblog/2008/03/03/wp-codebox/#examples" target="_blank" title="WP-CodeBox HowTo?"><span style="color: #99cc00">?</span></a></sup></span><span class="left"><a href="javascript:;" onclick="javascript:showCodeTxt(&#39;p978code2&#39;); return false;">View Code</a> CPP</span><div class="codebox_clear"></div></div><div class="wp_codebox" style="display: none;"><table><tbody><tr id="p9782"><td class="line_numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
</pre></td><td class="code" id="p978code2"><pre class="cpp" style="font-family:monospace;"><span style="color: #339900;">#include &lt;cstdio&gt;</span>
<span style="color: #339900;">#include &lt;algorithm&gt;</span>
<span style="color: #0000ff;">using</span> <span style="color: #0000ff;">namespace</span> std<span style="color: #008080;">;</span>
&nbsp;
<span style="color: #339900;">#define lson l , m , rt &lt;&lt; 1</span>
<span style="color: #339900;">#define rson m + 1 , r , rt &lt;&lt; 1 | 1</span>
<span style="color: #0000ff;">const</span> <span style="color: #0000ff;">int</span> maxn <span style="color: #000080;">=</span> <span style="color: #0000dd;">222222</span><span style="color: #008080;">;</span>
<span style="color: #0000ff;">int</span> MAX<span style="color: #008000;">[</span>maxn<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">2</span><span style="color: #008000;">]</span><span style="color: #008080;">;</span>
<span style="color: #0000ff;">void</span> PushUP<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> rt<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	MAX<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> max<span style="color: #008000;">(</span>MAX<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> , MAX<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #000040;">|</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">void</span> build<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> l,<span style="color: #0000ff;">int</span> r,<span style="color: #0000ff;">int</span> rt<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>l <span style="color: #000080;">==</span> r<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		<span style="color: #0000dd;">scanf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%d"</span>,<span style="color: #000040;">&amp;</span>MAX<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">return</span> <span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span>
	<span style="color: #0000ff;">int</span> m <span style="color: #000080;">=</span> <span style="color: #008000;">(</span>l <span style="color: #000040;">+</span> r<span style="color: #008000;">)</span> <span style="color: #000080;">&gt;&gt;</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
	build<span style="color: #008000;">(</span>lson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	build<span style="color: #008000;">(</span>rson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	PushUP<span style="color: #008000;">(</span>rt<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">void</span> update<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> p,<span style="color: #0000ff;">int</span> sc,<span style="color: #0000ff;">int</span> l,<span style="color: #0000ff;">int</span> r,<span style="color: #0000ff;">int</span> rt<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>l <span style="color: #000080;">==</span> r<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		MAX<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> sc<span style="color: #008080;">;</span>
		<span style="color: #0000ff;">return</span> <span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span>
	<span style="color: #0000ff;">int</span> m <span style="color: #000080;">=</span> <span style="color: #008000;">(</span>l <span style="color: #000040;">+</span> r<span style="color: #008000;">)</span> <span style="color: #000080;">&gt;&gt;</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>p <span style="color: #000080;">&lt;=</span> m<span style="color: #008000;">)</span> update<span style="color: #008000;">(</span>p , sc , lson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">else</span> update<span style="color: #008000;">(</span>p , sc , rson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	PushUP<span style="color: #008000;">(</span>rt<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">int</span> query<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> L,<span style="color: #0000ff;">int</span> R,<span style="color: #0000ff;">int</span> l,<span style="color: #0000ff;">int</span> r,<span style="color: #0000ff;">int</span> rt<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>L <span style="color: #000080;">&lt;=</span> l <span style="color: #000040;">&amp;&amp;</span> r <span style="color: #000080;">&lt;=</span> R<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		<span style="color: #0000ff;">return</span> MAX<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span><span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span>
	<span style="color: #0000ff;">int</span> m <span style="color: #000080;">=</span> <span style="color: #008000;">(</span>l <span style="color: #000040;">+</span> r<span style="color: #008000;">)</span> <span style="color: #000080;">&gt;&gt;</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">int</span> ret <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>L <span style="color: #000080;">&lt;=</span> m<span style="color: #008000;">)</span> ret <span style="color: #000080;">=</span> max<span style="color: #008000;">(</span>ret , query<span style="color: #008000;">(</span>L , R , lson<span style="color: #008000;">)</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>R <span style="color: #000080;">&gt;</span> m<span style="color: #008000;">)</span> ret <span style="color: #000080;">=</span> max<span style="color: #008000;">(</span>ret , query<span style="color: #008000;">(</span>L , R , rson<span style="color: #008000;">)</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">return</span> ret<span style="color: #008080;">;</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">int</span> main<span style="color: #008000;">(</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">int</span> n , m<span style="color: #008080;">;</span>
	<span style="color: #0000ff;">while</span> <span style="color: #008000;">(</span>~<span style="color: #0000dd;">scanf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%d%d"</span>,<span style="color: #000040;">&amp;</span>n,<span style="color: #000040;">&amp;</span>m<span style="color: #008000;">)</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		build<span style="color: #008000;">(</span><span style="color: #0000dd;">1</span> , n , <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">while</span> <span style="color: #008000;">(</span>m <span style="color: #000040;">--</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
			<span style="color: #0000ff;">char</span> op<span style="color: #008000;">[</span><span style="color: #0000dd;">2</span><span style="color: #008000;">]</span><span style="color: #008080;">;</span>
			<span style="color: #0000ff;">int</span> a , b<span style="color: #008080;">;</span>
			<span style="color: #0000dd;">scanf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%s%d%d"</span>,op,<span style="color: #000040;">&amp;</span>a,<span style="color: #000040;">&amp;</span>b<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
			<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>op<span style="color: #008000;">[</span><span style="color: #0000dd;">0</span><span style="color: #008000;">]</span> <span style="color: #000080;">==</span> <span style="color: #FF0000;">'Q'</span><span style="color: #008000;">)</span> <span style="color: #0000dd;">printf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%d<span style="color: #000099; font-weight: bold;">\n</span>"</span>,query<span style="color: #008000;">(</span>a , b , <span style="color: #0000dd;">1</span> , n , <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
			<span style="color: #0000ff;">else</span> update<span style="color: #008000;">(</span>a , b , <span style="color: #0000dd;">1</span> , n , <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		<span style="color: #008000;">}</span>
	<span style="color: #008000;">}</span>
	<span style="color: #0000ff;">return</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span></pre></td></tr></tbody></table></div>

</li>
<li>
<a href="http://acm.hdu.edu.cn/showproblem.php?pid=1394">hdu1394 Minimum Inversion Number</a><br>
题意:求Inversion后的最小逆序数<br>
思路:用O(nlogn)复杂度求出最初逆序数后,就可以用O(1)的复杂度分别递推出其他解<br>
线段树功能:update:单点增减 query:区间求和<p></p>

<div class="wp_codebox_msgheader wp_codebox_hide active"><span class="right"><sup><a href="http://www.ericbess.com/ericblog/2008/03/03/wp-codebox/#examples" target="_blank" title="WP-CodeBox HowTo?"><span style="color: #99cc00">?</span></a></sup></span><span class="left"><a href="javascript:;" onclick="javascript:showCodeTxt(&#39;p978code3&#39;); return false;">View Code</a> CPP</span><div class="codebox_clear"></div></div><div class="wp_codebox" style="display: none;"><table><tbody><tr id="p9783"><td class="line_numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
</pre></td><td class="code" id="p978code3"><pre class="cpp" style="font-family:monospace;"><span style="color: #339900;">#include &lt;cstdio&gt;</span>
<span style="color: #339900;">#include &lt;algorithm&gt;</span>
<span style="color: #0000ff;">using</span> <span style="color: #0000ff;">namespace</span> std<span style="color: #008080;">;</span>
&nbsp;
<span style="color: #339900;">#define lson l , m , rt &lt;&lt; 1</span>
<span style="color: #339900;">#define rson m + 1 , r , rt &lt;&lt; 1 | 1</span>
<span style="color: #0000ff;">const</span> <span style="color: #0000ff;">int</span> maxn <span style="color: #000080;">=</span> <span style="color: #0000dd;">5555</span><span style="color: #008080;">;</span>
<span style="color: #0000ff;">int</span> sum<span style="color: #008000;">[</span>maxn<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">2</span><span style="color: #008000;">]</span><span style="color: #008080;">;</span>
<span style="color: #0000ff;">void</span> PushUP<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> rt<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	sum<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> sum<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000040;">+</span> sum<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #000040;">|</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">void</span> build<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> l,<span style="color: #0000ff;">int</span> r,<span style="color: #0000ff;">int</span> rt<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	sum<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>l <span style="color: #000080;">==</span> r<span style="color: #008000;">)</span> <span style="color: #0000ff;">return</span> <span style="color: #008080;">;</span>
	<span style="color: #0000ff;">int</span> m <span style="color: #000080;">=</span> <span style="color: #008000;">(</span>l <span style="color: #000040;">+</span> r<span style="color: #008000;">)</span> <span style="color: #000080;">&gt;&gt;</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
	build<span style="color: #008000;">(</span>lson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	build<span style="color: #008000;">(</span>rson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">void</span> update<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> p,<span style="color: #0000ff;">int</span> l,<span style="color: #0000ff;">int</span> r,<span style="color: #0000ff;">int</span> rt<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>l <span style="color: #000080;">==</span> r<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		sum<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000040;">++</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">return</span> <span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span>
	<span style="color: #0000ff;">int</span> m <span style="color: #000080;">=</span> <span style="color: #008000;">(</span>l <span style="color: #000040;">+</span> r<span style="color: #008000;">)</span> <span style="color: #000080;">&gt;&gt;</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>p <span style="color: #000080;">&lt;=</span> m<span style="color: #008000;">)</span> update<span style="color: #008000;">(</span>p , lson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">else</span> update<span style="color: #008000;">(</span>p , rson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	PushUP<span style="color: #008000;">(</span>rt<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">int</span> query<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> L,<span style="color: #0000ff;">int</span> R,<span style="color: #0000ff;">int</span> l,<span style="color: #0000ff;">int</span> r,<span style="color: #0000ff;">int</span> rt<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>L <span style="color: #000080;">&lt;=</span> l <span style="color: #000040;">&amp;&amp;</span> r <span style="color: #000080;">&lt;=</span> R<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		<span style="color: #0000ff;">return</span> sum<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span><span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span>
	<span style="color: #0000ff;">int</span> m <span style="color: #000080;">=</span> <span style="color: #008000;">(</span>l <span style="color: #000040;">+</span> r<span style="color: #008000;">)</span> <span style="color: #000080;">&gt;&gt;</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">int</span> ret <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>L <span style="color: #000080;">&lt;=</span> m<span style="color: #008000;">)</span> ret <span style="color: #000040;">+</span><span style="color: #000080;">=</span> query<span style="color: #008000;">(</span>L , R , lson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>R <span style="color: #000080;">&gt;</span> m<span style="color: #008000;">)</span> ret <span style="color: #000040;">+</span><span style="color: #000080;">=</span> query<span style="color: #008000;">(</span>L , R , rson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">return</span> ret<span style="color: #008080;">;</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">int</span> x<span style="color: #008000;">[</span>maxn<span style="color: #008000;">]</span><span style="color: #008080;">;</span>
<span style="color: #0000ff;">int</span> main<span style="color: #008000;">(</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">int</span> n<span style="color: #008080;">;</span>
	<span style="color: #0000ff;">while</span> <span style="color: #008000;">(</span>~<span style="color: #0000dd;">scanf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%d"</span>,<span style="color: #000040;">&amp;</span>n<span style="color: #008000;">)</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		build<span style="color: #008000;">(</span><span style="color: #0000dd;">0</span> , n <span style="color: #000040;">-</span> <span style="color: #0000dd;">1</span> , <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">int</span> sum <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">for</span> <span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> i <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span> <span style="color: #008080;">;</span> i <span style="color: #000080;">&lt;</span> n <span style="color: #008080;">;</span> i <span style="color: #000040;">++</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
			<span style="color: #0000dd;">scanf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%d"</span>,<span style="color: #000040;">&amp;</span>x<span style="color: #008000;">[</span>i<span style="color: #008000;">]</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
			sum <span style="color: #000040;">+</span><span style="color: #000080;">=</span> query<span style="color: #008000;">(</span>x<span style="color: #008000;">[</span>i<span style="color: #008000;">]</span> , n <span style="color: #000040;">-</span> <span style="color: #0000dd;">1</span> , <span style="color: #0000dd;">0</span> , n <span style="color: #000040;">-</span> <span style="color: #0000dd;">1</span> , <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
			update<span style="color: #008000;">(</span>x<span style="color: #008000;">[</span>i<span style="color: #008000;">]</span> , <span style="color: #0000dd;">0</span> , n <span style="color: #000040;">-</span> <span style="color: #0000dd;">1</span> , <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		<span style="color: #008000;">}</span>
		<span style="color: #0000ff;">int</span> ret <span style="color: #000080;">=</span> sum<span style="color: #008080;">;</span>
		<span style="color: #0000ff;">for</span> <span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> i <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span> <span style="color: #008080;">;</span> i <span style="color: #000080;">&lt;</span> n <span style="color: #008080;">;</span> i <span style="color: #000040;">++</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
			sum <span style="color: #000040;">+</span><span style="color: #000080;">=</span> n <span style="color: #000040;">-</span> x<span style="color: #008000;">[</span>i<span style="color: #008000;">]</span> <span style="color: #000040;">-</span> x<span style="color: #008000;">[</span>i<span style="color: #008000;">]</span> <span style="color: #000040;">-</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
			ret <span style="color: #000080;">=</span> min<span style="color: #008000;">(</span>ret , sum<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		<span style="color: #008000;">}</span>
		<span style="color: #0000dd;">printf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%d<span style="color: #000099; font-weight: bold;">\n</span>"</span>,ret<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span>
	<span style="color: #0000ff;">return</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span></pre></td></tr></tbody></table></div>

</li>
<li>
<a href="http://acm.hdu.edu.cn/showproblem.php?pid=2795">hdu2795 Billboard</a><br>
题意:h*w的木板,放进一些1*L的物品,求每次放<b>空间能容纳且最上边</b>的位子<br>
思路:每次找到最大值的位子,然后减去L<br>
线段树功能:query:区间求最大值的位子(直接把update的操作在query里做了)<p></p>

<div class="wp_codebox_msgheader wp_codebox_hide active"><span class="right"><sup><a href="http://www.ericbess.com/ericblog/2008/03/03/wp-codebox/#examples" target="_blank" title="WP-CodeBox HowTo?"><span style="color: #99cc00">?</span></a></sup></span><span class="left"><a href="javascript:;" onclick="javascript:showCodeTxt(&#39;p978code4&#39;); return false;">View Code</a> CPP</span><div class="codebox_clear"></div></div><div class="wp_codebox" style="display: none;"><table><tbody><tr id="p9784"><td class="line_numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre></td><td class="code" id="p978code4"><pre class="cpp" style="font-family:monospace;"><span style="color: #339900;">#include &lt;cstdio&gt;</span>
<span style="color: #339900;">#include &lt;algorithm&gt;</span>
<span style="color: #0000ff;">using</span> <span style="color: #0000ff;">namespace</span> std<span style="color: #008080;">;</span>
&nbsp;
<span style="color: #339900;">#define lson l , m , rt &lt;&lt; 1</span>
<span style="color: #339900;">#define rson m + 1 , r , rt &lt;&lt; 1 | 1</span>
<span style="color: #0000ff;">const</span> <span style="color: #0000ff;">int</span> maxn <span style="color: #000080;">=</span> <span style="color: #0000dd;">222222</span><span style="color: #008080;">;</span>
<span style="color: #0000ff;">int</span> h , w , n<span style="color: #008080;">;</span>
<span style="color: #0000ff;">int</span> MAX<span style="color: #008000;">[</span>maxn<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">2</span><span style="color: #008000;">]</span><span style="color: #008080;">;</span>
<span style="color: #0000ff;">void</span> PushUP<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> rt<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	MAX<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> max<span style="color: #008000;">(</span>MAX<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> , MAX<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #000040;">|</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">void</span> build<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> l,<span style="color: #0000ff;">int</span> r,<span style="color: #0000ff;">int</span> rt<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	MAX<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> w<span style="color: #008080;">;</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>l <span style="color: #000080;">==</span> r<span style="color: #008000;">)</span> <span style="color: #0000ff;">return</span> <span style="color: #008080;">;</span>
	<span style="color: #0000ff;">int</span> m <span style="color: #000080;">=</span> <span style="color: #008000;">(</span>l <span style="color: #000040;">+</span> r<span style="color: #008000;">)</span> <span style="color: #000080;">&gt;&gt;</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
	build<span style="color: #008000;">(</span>lson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	build<span style="color: #008000;">(</span>rson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">int</span> query<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> x,<span style="color: #0000ff;">int</span> l,<span style="color: #0000ff;">int</span> r,<span style="color: #0000ff;">int</span> rt<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>l <span style="color: #000080;">==</span> r<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		MAX<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000040;">-</span><span style="color: #000080;">=</span> x<span style="color: #008080;">;</span>
		<span style="color: #0000ff;">return</span> l<span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span>
	<span style="color: #0000ff;">int</span> m <span style="color: #000080;">=</span> <span style="color: #008000;">(</span>l <span style="color: #000040;">+</span> r<span style="color: #008000;">)</span> <span style="color: #000080;">&gt;&gt;</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">int</span> ret <span style="color: #000080;">=</span> <span style="color: #008000;">(</span>MAX<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000080;">&gt;=</span> x<span style="color: #008000;">)</span> <span style="color: #008080;">?</span> query<span style="color: #008000;">(</span>x , lson<span style="color: #008000;">)</span> <span style="color: #008080;">:</span> query<span style="color: #008000;">(</span>x , rson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	PushUP<span style="color: #008000;">(</span>rt<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">return</span> ret<span style="color: #008080;">;</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">int</span> main<span style="color: #008000;">(</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">while</span> <span style="color: #008000;">(</span>~<span style="color: #0000dd;">scanf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%d%d%d"</span>,<span style="color: #000040;">&amp;</span>h,<span style="color: #000040;">&amp;</span>w,<span style="color: #000040;">&amp;</span>n<span style="color: #008000;">)</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>h <span style="color: #000080;">&gt;</span> n<span style="color: #008000;">)</span> h <span style="color: #000080;">=</span> n<span style="color: #008080;">;</span>
		build<span style="color: #008000;">(</span><span style="color: #0000dd;">1</span> , h , <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">while</span> <span style="color: #008000;">(</span>n <span style="color: #000040;">--</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
			<span style="color: #0000ff;">int</span> x<span style="color: #008080;">;</span>
			<span style="color: #0000dd;">scanf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%d"</span>,<span style="color: #000040;">&amp;</span>x<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
			<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>MAX<span style="color: #008000;">[</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000080;">&lt;</span> x<span style="color: #008000;">)</span> <span style="color: #0000dd;">puts</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"-1"</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
			<span style="color: #0000ff;">else</span> <span style="color: #0000dd;">printf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%d<span style="color: #000099; font-weight: bold;">\n</span>"</span>,query<span style="color: #008000;">(</span>x , <span style="color: #0000dd;">1</span> , h , <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		<span style="color: #008000;">}</span>
	<span style="color: #008000;">}</span>
	<span style="color: #0000ff;">return</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span></pre></td></tr></tbody></table></div>

</li>
<li>练习<br>
<a href="http://poj.org/problem?id=2828">poj2828 Buy Tickets</a><br>
<a href="http://poj.org/problem?id=2886">poj2886 Who Gets the Most Candies?</a>
</li>
</ul>
</li>
<li>
<span style="color:#ff0000">成段更新</span>(通常这对初学者来说是一道坎),需要用到延迟标记(或者说懒惰标记),简单来说就是每次更新的时候不要更新到底,用延迟标记使得更新延迟到下次需要更新or询问到的时候<p></p>
<ul>
<li>
<a href="http://acm.hdu.edu.cn/showproblem.php?pid=1698">hdu1698 Just a Hook</a><br>
题意:O(-1)<br>
思路:O(-1)<br>
线段树功能:update:成段替换 (由于只query一次总区间,所以可以直接输出1结点的信息)<p></p>

<div class="wp_codebox_msgheader wp_codebox_hide active"><span class="right"><sup><a href="http://www.ericbess.com/ericblog/2008/03/03/wp-codebox/#examples" target="_blank" title="WP-CodeBox HowTo?"><span style="color: #99cc00">?</span></a></sup></span><span class="left"><a href="javascript:;" onclick="javascript:showCodeTxt(&#39;p978code5&#39;); return false;">View Code</a> CPP</span><div class="codebox_clear"></div></div><div class="wp_codebox" style="display: none;"><table><tbody><tr id="p9785"><td class="line_numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
</pre></td><td class="code" id="p978code5"><pre class="cpp" style="font-family:monospace;"><span style="color: #339900;">#include &lt;cstdio&gt;</span>
<span style="color: #339900;">#include &lt;algorithm&gt;</span>
<span style="color: #0000ff;">using</span> <span style="color: #0000ff;">namespace</span> std<span style="color: #008080;">;</span>
&nbsp;
<span style="color: #339900;">#define lson l , m , rt &lt;&lt; 1</span>
<span style="color: #339900;">#define rson m + 1 , r , rt &lt;&lt; 1 | 1</span>
<span style="color: #0000ff;">const</span> <span style="color: #0000ff;">int</span> maxn <span style="color: #000080;">=</span> <span style="color: #0000dd;">111111</span><span style="color: #008080;">;</span>
<span style="color: #0000ff;">int</span> h , w , n<span style="color: #008080;">;</span>
<span style="color: #0000ff;">int</span> col<span style="color: #008000;">[</span>maxn<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">2</span><span style="color: #008000;">]</span><span style="color: #008080;">;</span>
<span style="color: #0000ff;">int</span> sum<span style="color: #008000;">[</span>maxn<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">2</span><span style="color: #008000;">]</span><span style="color: #008080;">;</span>
<span style="color: #0000ff;">void</span> PushUp<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> rt<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	sum<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> sum<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000040;">+</span> sum<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #000040;">|</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">void</span> PushDown<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> rt,<span style="color: #0000ff;">int</span> m<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>col<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		col<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000080;">=</span> col<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #000040;">|</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000080;">=</span> col<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span><span style="color: #008080;">;</span>
		sum<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000080;">=</span> <span style="color: #008000;">(</span>m <span style="color: #000040;">-</span> <span style="color: #008000;">(</span>m <span style="color: #000080;">&gt;&gt;</span> <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008000;">)</span> <span style="color: #000040;">*</span> col<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span><span style="color: #008080;">;</span>
		sum<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #000040;">|</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000080;">=</span> <span style="color: #008000;">(</span>m <span style="color: #000080;">&gt;&gt;</span> <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span> <span style="color: #000040;">*</span> col<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span><span style="color: #008080;">;</span>
		col<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">void</span> build<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> l,<span style="color: #0000ff;">int</span> r,<span style="color: #0000ff;">int</span> rt<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	col<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
	sum<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>l <span style="color: #000080;">==</span> r<span style="color: #008000;">)</span> <span style="color: #0000ff;">return</span> <span style="color: #008080;">;</span>
	<span style="color: #0000ff;">int</span> m <span style="color: #000080;">=</span> <span style="color: #008000;">(</span>l <span style="color: #000040;">+</span> r<span style="color: #008000;">)</span> <span style="color: #000080;">&gt;&gt;</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
	build<span style="color: #008000;">(</span>lson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	build<span style="color: #008000;">(</span>rson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	PushUp<span style="color: #008000;">(</span>rt<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">void</span> update<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> L,<span style="color: #0000ff;">int</span> R,<span style="color: #0000ff;">int</span> c,<span style="color: #0000ff;">int</span> l,<span style="color: #0000ff;">int</span> r,<span style="color: #0000ff;">int</span> rt<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>L <span style="color: #000080;">&lt;=</span> l <span style="color: #000040;">&amp;&amp;</span> r <span style="color: #000080;">&lt;=</span> R<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		col<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> c<span style="color: #008080;">;</span>
		sum<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> c <span style="color: #000040;">*</span> <span style="color: #008000;">(</span>r <span style="color: #000040;">-</span> l <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">return</span> <span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span>
	PushDown<span style="color: #008000;">(</span>rt , r <span style="color: #000040;">-</span> l <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">int</span> m <span style="color: #000080;">=</span> <span style="color: #008000;">(</span>l <span style="color: #000040;">+</span> r<span style="color: #008000;">)</span> <span style="color: #000080;">&gt;&gt;</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>L <span style="color: #000080;">&lt;=</span> m<span style="color: #008000;">)</span> update<span style="color: #008000;">(</span>L , R , c , lson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>R <span style="color: #000080;">&gt;</span> m<span style="color: #008000;">)</span> update<span style="color: #008000;">(</span>L , R , c , rson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	PushUp<span style="color: #008000;">(</span>rt<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">int</span> main<span style="color: #008000;">(</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">int</span> T , n , m<span style="color: #008080;">;</span>
	<span style="color: #0000dd;">scanf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%d"</span>,<span style="color: #000040;">&amp;</span>T<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">for</span> <span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> cas <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span> <span style="color: #008080;">;</span> cas <span style="color: #000080;">&lt;=</span> T <span style="color: #008080;">;</span> cas <span style="color: #000040;">++</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		<span style="color: #0000dd;">scanf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%d%d"</span>,<span style="color: #000040;">&amp;</span>n,<span style="color: #000040;">&amp;</span>m<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		build<span style="color: #008000;">(</span><span style="color: #0000dd;">1</span> , n , <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">while</span> <span style="color: #008000;">(</span>m <span style="color: #000040;">--</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
			<span style="color: #0000ff;">int</span> a , b , c<span style="color: #008080;">;</span>
			<span style="color: #0000dd;">scanf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%d%d%d"</span>,<span style="color: #000040;">&amp;</span>a,<span style="color: #000040;">&amp;</span>b,<span style="color: #000040;">&amp;</span>c<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
			update<span style="color: #008000;">(</span>a , b , c , <span style="color: #0000dd;">1</span> , n , <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		<span style="color: #008000;">}</span>
		<span style="color: #0000dd;">printf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"Case %d: The total value of the hook is %d.<span style="color: #000099; font-weight: bold;">\n</span>"</span>,cas , sum<span style="color: #008000;">[</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span>
	<span style="color: #0000ff;">return</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span></pre></td></tr></tbody></table></div>

</li>
<li>
<a href="http://poj.org/problem?id=3468">poj3468 A Simple Problem with Integers</a><br>
题意:O(-1)<br>
思路:O(-1)<br>
线段树功能:update:成段增减 query:区间求和<p></p>

<div class="wp_codebox_msgheader wp_codebox_hide active"><span class="right"><sup><a href="http://www.ericbess.com/ericblog/2008/03/03/wp-codebox/#examples" target="_blank" title="WP-CodeBox HowTo?"><span style="color: #99cc00">?</span></a></sup></span><span class="left"><a href="javascript:;" onclick="javascript:showCodeTxt(&#39;p978code6&#39;); return false;">View Code</a> CPP</span><div class="codebox_clear"></div></div><div class="wp_codebox" style="display: none;"><table><tbody><tr id="p9786"><td class="line_numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
</pre></td><td class="code" id="p978code6"><pre class="cpp" style="font-family:monospace;"><span style="color: #339900;">#include &lt;cstdio&gt;</span>
<span style="color: #339900;">#include &lt;algorithm&gt;</span>
<span style="color: #0000ff;">using</span> <span style="color: #0000ff;">namespace</span> std<span style="color: #008080;">;</span>
&nbsp;
<span style="color: #339900;">#define lson l , m , rt &lt;&lt; 1</span>
<span style="color: #339900;">#define rson m + 1 , r , rt &lt;&lt; 1 | 1</span>
<span style="color: #339900;">#define LL long long</span>
<span style="color: #0000ff;">const</span> <span style="color: #0000ff;">int</span> maxn <span style="color: #000080;">=</span> <span style="color: #0000dd;">111111</span><span style="color: #008080;">;</span>
LL add<span style="color: #008000;">[</span>maxn<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">2</span><span style="color: #008000;">]</span><span style="color: #008080;">;</span>
LL sum<span style="color: #008000;">[</span>maxn<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">2</span><span style="color: #008000;">]</span><span style="color: #008080;">;</span>
<span style="color: #0000ff;">void</span> PushUp<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> rt<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	sum<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> sum<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000040;">+</span> sum<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #000040;">|</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">void</span> PushDown<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> rt,<span style="color: #0000ff;">int</span> m<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>add<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		add<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000040;">+</span><span style="color: #000080;">=</span> add<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span><span style="color: #008080;">;</span>
		add<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #000040;">|</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000040;">+</span><span style="color: #000080;">=</span> add<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span><span style="color: #008080;">;</span>
		sum<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000040;">+</span><span style="color: #000080;">=</span> add<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000040;">*</span> <span style="color: #008000;">(</span>m <span style="color: #000040;">-</span> <span style="color: #008000;">(</span>m <span style="color: #000080;">&gt;&gt;</span> <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		sum<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #000040;">|</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000040;">+</span><span style="color: #000080;">=</span> add<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000040;">*</span> <span style="color: #008000;">(</span>m <span style="color: #000080;">&gt;&gt;</span> <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		add<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">void</span> build<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> l,<span style="color: #0000ff;">int</span> r,<span style="color: #0000ff;">int</span> rt<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	add<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>l <span style="color: #000080;">==</span> r<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		<span style="color: #0000dd;">scanf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%lld"</span>,<span style="color: #000040;">&amp;</span>sum<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">return</span> <span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span>
	<span style="color: #0000ff;">int</span> m <span style="color: #000080;">=</span> <span style="color: #008000;">(</span>l <span style="color: #000040;">+</span> r<span style="color: #008000;">)</span> <span style="color: #000080;">&gt;&gt;</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
	build<span style="color: #008000;">(</span>lson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	build<span style="color: #008000;">(</span>rson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	PushUp<span style="color: #008000;">(</span>rt<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">void</span> update<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> L,<span style="color: #0000ff;">int</span> R,<span style="color: #0000ff;">int</span> c,<span style="color: #0000ff;">int</span> l,<span style="color: #0000ff;">int</span> r,<span style="color: #0000ff;">int</span> rt<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>L <span style="color: #000080;">&lt;=</span> l <span style="color: #000040;">&amp;&amp;</span> r <span style="color: #000080;">&lt;=</span> R<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		add<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000040;">+</span><span style="color: #000080;">=</span> c<span style="color: #008080;">;</span>
		sum<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000040;">+</span><span style="color: #000080;">=</span> <span style="color: #008000;">(</span>LL<span style="color: #008000;">)</span>c <span style="color: #000040;">*</span> <span style="color: #008000;">(</span>r <span style="color: #000040;">-</span> l <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">return</span> <span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span>
	PushDown<span style="color: #008000;">(</span>rt , r <span style="color: #000040;">-</span> l <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">int</span> m <span style="color: #000080;">=</span> <span style="color: #008000;">(</span>l <span style="color: #000040;">+</span> r<span style="color: #008000;">)</span> <span style="color: #000080;">&gt;&gt;</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>L <span style="color: #000080;">&lt;=</span> m<span style="color: #008000;">)</span> update<span style="color: #008000;">(</span>L , R , c , lson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>m <span style="color: #000080;">&lt;</span> R<span style="color: #008000;">)</span> update<span style="color: #008000;">(</span>L , R , c , rson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	PushUp<span style="color: #008000;">(</span>rt<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span>
LL query<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> L,<span style="color: #0000ff;">int</span> R,<span style="color: #0000ff;">int</span> l,<span style="color: #0000ff;">int</span> r,<span style="color: #0000ff;">int</span> rt<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>L <span style="color: #000080;">&lt;=</span> l <span style="color: #000040;">&amp;&amp;</span> r <span style="color: #000080;">&lt;=</span> R<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		<span style="color: #0000ff;">return</span> sum<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span><span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span>
	PushDown<span style="color: #008000;">(</span>rt , r <span style="color: #000040;">-</span> l <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">int</span> m <span style="color: #000080;">=</span> <span style="color: #008000;">(</span>l <span style="color: #000040;">+</span> r<span style="color: #008000;">)</span> <span style="color: #000080;">&gt;&gt;</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
	LL ret <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>L <span style="color: #000080;">&lt;=</span> m<span style="color: #008000;">)</span> ret <span style="color: #000040;">+</span><span style="color: #000080;">=</span> query<span style="color: #008000;">(</span>L , R , lson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>m <span style="color: #000080;">&lt;</span> R<span style="color: #008000;">)</span> ret <span style="color: #000040;">+</span><span style="color: #000080;">=</span> query<span style="color: #008000;">(</span>L , R , rson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">return</span> ret<span style="color: #008080;">;</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">int</span> main<span style="color: #008000;">(</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">int</span> N , Q<span style="color: #008080;">;</span>
	<span style="color: #0000dd;">scanf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%d%d"</span>,<span style="color: #000040;">&amp;</span>N,<span style="color: #000040;">&amp;</span>Q<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	build<span style="color: #008000;">(</span><span style="color: #0000dd;">1</span> , N , <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">while</span> <span style="color: #008000;">(</span>Q <span style="color: #000040;">--</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		<span style="color: #0000ff;">char</span> op<span style="color: #008000;">[</span><span style="color: #0000dd;">2</span><span style="color: #008000;">]</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">int</span> a , b , c<span style="color: #008080;">;</span>
		<span style="color: #0000dd;">scanf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%s"</span>,op<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>op<span style="color: #008000;">[</span><span style="color: #0000dd;">0</span><span style="color: #008000;">]</span> <span style="color: #000080;">==</span> <span style="color: #FF0000;">'Q'</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
			<span style="color: #0000dd;">scanf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%d%d"</span>,<span style="color: #000040;">&amp;</span>a,<span style="color: #000040;">&amp;</span>b<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
			<span style="color: #0000dd;">printf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%lld<span style="color: #000099; font-weight: bold;">\n</span>"</span>,query<span style="color: #008000;">(</span>a , b , <span style="color: #0000dd;">1</span> , N , <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		<span style="color: #008000;">}</span> <span style="color: #0000ff;">else</span> <span style="color: #008000;">{</span>
			<span style="color: #0000dd;">scanf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%d%d%d"</span>,<span style="color: #000040;">&amp;</span>a,<span style="color: #000040;">&amp;</span>b,<span style="color: #000040;">&amp;</span>c<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
			update<span style="color: #008000;">(</span>a , b , c , <span style="color: #0000dd;">1</span> , N , <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		<span style="color: #008000;">}</span>
	<span style="color: #008000;">}</span>
	<span style="color: #0000ff;">return</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span></pre></td></tr></tbody></table></div>

</li>
<li>
<a href="http://poj.org/problem?id=2528">poj2528 Mayor’s posters</a><br>
题意:在墙上贴海报,海报可以互相覆盖,问最后可以看见几张海报<br>
思路:这题数据范围很大,直接搞超时+超内存,需要离散化:<br>
离散化简单的来说就是只取我们<b>需要的值</b>来用,比如说区间[1000,2000],[1990,2012] 我们用不到[-∞,999][1001,1989][1991,1999][2001,2011][2013,+∞]这些值,所以我只需要1000,1990,2000,2012就够了,将其分别映射到0,1,2,3,在于复杂度就大大的降下来了<br>
所以离散化要保存所有需要用到的值,排序后,分别映射到1~n,这样复杂度就会小很多很多<br>
而这题的难点在于每个数字其实表示的是一个单位长度(并非一个点),这样普通的离散化会造成许多错误(包括我以前的代码,poj这题数据奇弱)<br>
给出下面两个简单的例子应该能体现普通离散化的缺陷:<br>
例子一:1-10 1-4 5-10<br>
例子二:1-10 1-4 6-10<br>
普通离散化后都变成了[1,4][1,2][3,4]<br>
线段2覆盖了[1,2],线段3覆盖了[3,4],那么线段1是否被完全覆盖掉了呢?<br>
例子一是完全被覆盖掉了,而例子二没有被覆盖<p></p>
<p>为了解决这种缺陷,我们可以在排序后的数组上加些处理,比如说[1,2,6,10]<br>
如果相邻数字间距大于1的话,在其中加上任意一个数字,比如加成[1,2,3,6,7,10],然后再做线段树就好了.<br>
线段树功能:update:成段替换 query:简单hash</p>

<div class="wp_codebox_msgheader wp_codebox_hide active"><span class="right"><sup><a href="http://www.ericbess.com/ericblog/2008/03/03/wp-codebox/#examples" target="_blank" title="WP-CodeBox HowTo?"><span style="color: #99cc00">?</span></a></sup></span><span class="left"><a href="javascript:;" onclick="javascript:showCodeTxt(&#39;p978code7&#39;); return false;">View Code</a> CPP</span><div class="codebox_clear"></div></div><div class="wp_codebox" style="display: none;"><table><tbody><tr id="p9787"><td class="line_numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
</pre></td><td class="code" id="p978code7"><pre class="cpp" style="font-family:monospace;"><span style="color: #339900;">#include &lt;cstdio&gt;</span>
<span style="color: #339900;">#include &lt;cstring&gt;</span>
<span style="color: #339900;">#include &lt;algorithm&gt;</span>
<span style="color: #0000ff;">using</span> <span style="color: #0000ff;">namespace</span> std<span style="color: #008080;">;</span>
<span style="color: #339900;">#define lson l , m , rt &lt;&lt; 1</span>
<span style="color: #339900;">#define rson m + 1 , r , rt &lt;&lt; 1 | 1</span>
&nbsp;
<span style="color: #0000ff;">const</span> <span style="color: #0000ff;">int</span> maxn <span style="color: #000080;">=</span> <span style="color: #0000dd;">11111</span><span style="color: #008080;">;</span>
<span style="color: #0000ff;">bool</span> hash<span style="color: #008000;">[</span>maxn<span style="color: #008000;">]</span><span style="color: #008080;">;</span>
<span style="color: #0000ff;">int</span> li<span style="color: #008000;">[</span>maxn<span style="color: #008000;">]</span> , ri<span style="color: #008000;">[</span>maxn<span style="color: #008000;">]</span><span style="color: #008080;">;</span>
<span style="color: #0000ff;">int</span> X<span style="color: #008000;">[</span>maxn<span style="color: #000040;">*</span><span style="color: #0000dd;">3</span><span style="color: #008000;">]</span><span style="color: #008080;">;</span>
<span style="color: #0000ff;">int</span> col<span style="color: #008000;">[</span>maxn<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">4</span><span style="color: #008000;">]</span><span style="color: #008080;">;</span>
<span style="color: #0000ff;">int</span> cnt<span style="color: #008080;">;</span>
&nbsp;
<span style="color: #0000ff;">void</span> PushDown<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> rt<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>col<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000040;">!</span><span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		col<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000080;">=</span> col<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #000040;">|</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000080;">=</span> col<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span><span style="color: #008080;">;</span>
		col<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">void</span> update<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> L,<span style="color: #0000ff;">int</span> R,<span style="color: #0000ff;">int</span> c,<span style="color: #0000ff;">int</span> l,<span style="color: #0000ff;">int</span> r,<span style="color: #0000ff;">int</span> rt<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>L <span style="color: #000080;">&lt;=</span> l <span style="color: #000040;">&amp;&amp;</span> r <span style="color: #000080;">&lt;=</span> R<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		col<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> c<span style="color: #008080;">;</span>
		<span style="color: #0000ff;">return</span> <span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span>
	PushDown<span style="color: #008000;">(</span>rt<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">int</span> m <span style="color: #000080;">=</span> <span style="color: #008000;">(</span>l <span style="color: #000040;">+</span> r<span style="color: #008000;">)</span> <span style="color: #000080;">&gt;&gt;</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>L <span style="color: #000080;">&lt;=</span> m<span style="color: #008000;">)</span> update<span style="color: #008000;">(</span>L , R , c , lson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>m <span style="color: #000080;">&lt;</span> R<span style="color: #008000;">)</span> update<span style="color: #008000;">(</span>L , R , c , rson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">void</span> query<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> l,<span style="color: #0000ff;">int</span> r,<span style="color: #0000ff;">int</span> rt<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>col<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000040;">!</span><span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span><span style="color: #000040;">!</span>hash<span style="color: #008000;">[</span>col<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span><span style="color: #008000;">]</span><span style="color: #008000;">)</span> cnt <span style="color: #000040;">++</span><span style="color: #008080;">;</span>
		hash<span style="color: #008000;">[</span> col<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #008000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000ff;">true</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">return</span> <span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>l <span style="color: #000080;">==</span> r<span style="color: #008000;">)</span> <span style="color: #0000ff;">return</span> <span style="color: #008080;">;</span>
	<span style="color: #0000ff;">int</span> m <span style="color: #000080;">=</span> <span style="color: #008000;">(</span>l <span style="color: #000040;">+</span> r<span style="color: #008000;">)</span> <span style="color: #000080;">&gt;&gt;</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
	query<span style="color: #008000;">(</span>lson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	query<span style="color: #008000;">(</span>rson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">int</span> Bin<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> key,<span style="color: #0000ff;">int</span> n,<span style="color: #0000ff;">int</span> X<span style="color: #008000;">[</span><span style="color: #008000;">]</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">int</span> l <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span> , r <span style="color: #000080;">=</span> n <span style="color: #000040;">-</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">while</span> <span style="color: #008000;">(</span>l <span style="color: #000080;">&lt;=</span> r<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		<span style="color: #0000ff;">int</span> m <span style="color: #000080;">=</span> <span style="color: #008000;">(</span>l <span style="color: #000040;">+</span> r<span style="color: #008000;">)</span> <span style="color: #000080;">&gt;&gt;</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>X<span style="color: #008000;">[</span>m<span style="color: #008000;">]</span> <span style="color: #000080;">==</span> key<span style="color: #008000;">)</span> <span style="color: #0000ff;">return</span> m<span style="color: #008080;">;</span>
		<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>X<span style="color: #008000;">[</span>m<span style="color: #008000;">]</span> <span style="color: #000080;">&lt;</span> key<span style="color: #008000;">)</span> l <span style="color: #000080;">=</span> m <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">else</span> r <span style="color: #000080;">=</span> m <span style="color: #000040;">-</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span>
	<span style="color: #0000ff;">return</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">int</span> main<span style="color: #008000;">(</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">int</span> T , n<span style="color: #008080;">;</span>
	<span style="color: #0000dd;">scanf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%d"</span>,<span style="color: #000040;">&amp;</span>T<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">while</span> <span style="color: #008000;">(</span>T <span style="color: #000040;">--</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		<span style="color: #0000dd;">scanf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%d"</span>,<span style="color: #000040;">&amp;</span>n<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">int</span> nn <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">for</span> <span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> i <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span> <span style="color: #008080;">;</span> i <span style="color: #000080;">&lt;</span> n <span style="color: #008080;">;</span> i <span style="color: #000040;">++</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
			<span style="color: #0000dd;">scanf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%d%d"</span>,<span style="color: #000040;">&amp;</span>li<span style="color: #008000;">[</span>i<span style="color: #008000;">]</span> , <span style="color: #000040;">&amp;</span>ri<span style="color: #008000;">[</span>i<span style="color: #008000;">]</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
			X<span style="color: #008000;">[</span>nn<span style="color: #000040;">++</span><span style="color: #008000;">]</span> <span style="color: #000080;">=</span> li<span style="color: #008000;">[</span>i<span style="color: #008000;">]</span><span style="color: #008080;">;</span>
			X<span style="color: #008000;">[</span>nn<span style="color: #000040;">++</span><span style="color: #008000;">]</span> <span style="color: #000080;">=</span> ri<span style="color: #008000;">[</span>i<span style="color: #008000;">]</span><span style="color: #008080;">;</span>
		<span style="color: #008000;">}</span>
		sort<span style="color: #008000;">(</span>X , X <span style="color: #000040;">+</span> nn<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">int</span> m <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">for</span> <span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> i <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span> <span style="color: #008080;">;</span> i <span style="color: #000080;">&lt;</span> nn<span style="color: #008080;">;</span> i <span style="color: #000040;">++</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
			<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>X<span style="color: #008000;">[</span>i<span style="color: #008000;">]</span> <span style="color: #000040;">!</span><span style="color: #000080;">=</span> X<span style="color: #008000;">[</span>i<span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span><span style="color: #008000;">)</span> X<span style="color: #008000;">[</span>m <span style="color: #000040;">++</span><span style="color: #008000;">]</span> <span style="color: #000080;">=</span> X<span style="color: #008000;">[</span>i<span style="color: #008000;">]</span><span style="color: #008080;">;</span>
		<span style="color: #008000;">}</span>
		<span style="color: #0000ff;">for</span> <span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> i <span style="color: #000080;">=</span> m <span style="color: #000040;">-</span> <span style="color: #0000dd;">1</span> <span style="color: #008080;">;</span> i <span style="color: #000080;">&gt;</span> <span style="color: #0000dd;">0</span> <span style="color: #008080;">;</span> i <span style="color: #000040;">--</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
			<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>X<span style="color: #008000;">[</span>i<span style="color: #008000;">]</span> <span style="color: #000040;">!</span><span style="color: #000080;">=</span> X<span style="color: #008000;">[</span>i<span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span> X<span style="color: #008000;">[</span>m <span style="color: #000040;">++</span><span style="color: #008000;">]</span> <span style="color: #000080;">=</span> X<span style="color: #008000;">[</span>i<span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
		<span style="color: #008000;">}</span>
		sort<span style="color: #008000;">(</span>X , X <span style="color: #000040;">+</span> m<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		<span style="color: #0000dd;">memset</span><span style="color: #008000;">(</span>col , <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span> , <span style="color: #0000dd;">sizeof</span><span style="color: #008000;">(</span>col<span style="color: #008000;">)</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">for</span> <span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> i <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span> <span style="color: #008080;">;</span> i <span style="color: #000080;">&lt;</span> n <span style="color: #008080;">;</span> i <span style="color: #000040;">++</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
			<span style="color: #0000ff;">int</span> l <span style="color: #000080;">=</span> Bin<span style="color: #008000;">(</span>li<span style="color: #008000;">[</span>i<span style="color: #008000;">]</span>, m, X<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
			<span style="color: #0000ff;">int</span> r <span style="color: #000080;">=</span> Bin<span style="color: #008000;">(</span>ri<span style="color: #008000;">[</span>i<span style="color: #008000;">]</span>, m, X<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
			update<span style="color: #008000;">(</span>l, r, i, <span style="color: #0000dd;">0</span>, m <span style="color: #000040;">-</span> <span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		<span style="color: #008000;">}</span>
		cnt <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
		<span style="color: #0000dd;">memset</span><span style="color: #008000;">(</span>hash, <span style="color: #0000ff;">false</span>, <span style="color: #0000dd;">sizeof</span><span style="color: #008000;">(</span>hash<span style="color: #008000;">)</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		query<span style="color: #008000;">(</span><span style="color: #0000dd;">0</span>, m <span style="color: #000040;">-</span> <span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		<span style="color: #0000dd;">printf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%d<span style="color: #000099; font-weight: bold;">\n</span>"</span>,cnt<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span>
	<span style="color: #0000ff;">return</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span></pre></td></tr></tbody></table></div>

</li>
<li>
<a href="http://poj.org/problem?id=3225">poj3225 Help with Intervals</a><br>
题意:区间操作,交,并,补等<br>
思路:<br>
我们一个一个操作来分析:(用0和1表示是否包含区间,-1表示该区间内既有包含又有不包含)<br>
U:把区间[l,r]覆盖成1<br>
I:把[-∞,l)(r,∞]覆盖成0<br>
D:把区间[l,r]覆盖成0<br>
C:把[-∞,l)(r,∞]覆盖成0 , 且[l,r]区间0/1互换<br>
S:[l,r]区间0/1互换<p></p>
<p>成段覆盖的操作很简单,比较特殊的就是<b>区间0/1互换</b>这个操作,我们可以称之为异或操作<br>
很明显我们可以知道这个性质:当一个区间被覆盖后,不管之前有没有异或标记都没有意义了<br>
所以当一个节点得到覆盖标记时把异或标记清空<br>
而当一个节点得到异或标记的时候,先判断覆盖标记,如果是0或1,直接改变一下覆盖标记,不然的话改变异或标记</p>
<p>开区间闭区间只要数字乘以2就可以处理(偶数表示端点,奇数表示两端点间的区间)<br>
线段树功能:update:成段替换,区间异或 query:简单hash</p>

<div class="wp_codebox_msgheader wp_codebox_hide active"><span class="right"><sup><a href="http://www.ericbess.com/ericblog/2008/03/03/wp-codebox/#examples" target="_blank" title="WP-CodeBox HowTo?"><span style="color: #99cc00">?</span></a></sup></span><span class="left"><a href="javascript:;" onclick="javascript:showCodeTxt(&#39;p978code8&#39;); return false;">View Code</a> CPP</span><div class="codebox_clear"></div></div><div class="wp_codebox" style="display: none;"><table><tbody><tr id="p9788"><td class="line_numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
</pre></td><td class="code" id="p978code8"><pre class="cpp" style="font-family:monospace;"><span style="color: #339900;">#include &lt;cstdio&gt;</span>
<span style="color: #339900;">#include &lt;cstring&gt;</span>
<span style="color: #339900;">#include &lt;cctype&gt;</span>
<span style="color: #339900;">#include &lt;algorithm&gt;</span>
<span style="color: #0000ff;">using</span> <span style="color: #0000ff;">namespace</span> std<span style="color: #008080;">;</span>
<span style="color: #339900;">#define lson l , m , rt &lt;&lt; 1</span>
<span style="color: #339900;">#define rson m + 1 , r , rt &lt;&lt; 1 | 1</span>
&nbsp;
<span style="color: #0000ff;">const</span> <span style="color: #0000ff;">int</span> maxn <span style="color: #000080;">=</span> <span style="color: #0000dd;">131072</span><span style="color: #008080;">;</span>
<span style="color: #0000ff;">bool</span> hash<span style="color: #008000;">[</span>maxn<span style="color: #000040;">+</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span><span style="color: #008080;">;</span>
<span style="color: #0000ff;">int</span> cover<span style="color: #008000;">[</span>maxn<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">2</span><span style="color: #008000;">]</span><span style="color: #008080;">;</span>
<span style="color: #0000ff;">int</span> XOR<span style="color: #008000;">[</span>maxn<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">2</span><span style="color: #008000;">]</span><span style="color: #008080;">;</span>
<span style="color: #0000ff;">void</span> FXOR<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> rt<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>cover<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000040;">!</span><span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #008000;">)</span> cover<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000040;">^</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">else</span> XOR<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000040;">^</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">void</span> PushDown<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> rt<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>cover<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000040;">!</span><span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		cover<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000080;">=</span> cover<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #000040;">|</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000080;">=</span> cover<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span><span style="color: #008080;">;</span>
		XOR<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000080;">=</span> XOR<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #000040;">|</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
		cover<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>XOR<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		FXOR<span style="color: #008000;">(</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		FXOR<span style="color: #008000;">(</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #000040;">|</span><span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		XOR<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">void</span> update<span style="color: #008000;">(</span><span style="color: #0000ff;">char</span> op,<span style="color: #0000ff;">int</span> L,<span style="color: #0000ff;">int</span> R,<span style="color: #0000ff;">int</span> l,<span style="color: #0000ff;">int</span> r,<span style="color: #0000ff;">int</span> rt<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>L <span style="color: #000080;">&lt;=</span> l <span style="color: #000040;">&amp;&amp;</span> r <span style="color: #000080;">&lt;=</span> R<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>op <span style="color: #000080;">==</span> <span style="color: #FF0000;">'U'</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
			cover<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
			XOR<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
		<span style="color: #008000;">}</span> <span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>op <span style="color: #000080;">==</span> <span style="color: #FF0000;">'D'</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
			cover<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
			XOR<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
		<span style="color: #008000;">}</span> <span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>op <span style="color: #000080;">==</span> <span style="color: #FF0000;">'C'</span> <span style="color: #000040;">||</span> op <span style="color: #000080;">==</span> <span style="color: #FF0000;">'S'</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
			FXOR<span style="color: #008000;">(</span>rt<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		<span style="color: #008000;">}</span>
		<span style="color: #0000ff;">return</span> <span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span>
	PushDown<span style="color: #008000;">(</span>rt<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">int</span> m <span style="color: #000080;">=</span> <span style="color: #008000;">(</span>l <span style="color: #000040;">+</span> r<span style="color: #008000;">)</span> <span style="color: #000080;">&gt;&gt;</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>L <span style="color: #000080;">&lt;=</span> m<span style="color: #008000;">)</span> update<span style="color: #008000;">(</span>op , L , R , lson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>op <span style="color: #000080;">==</span> <span style="color: #FF0000;">'I'</span> <span style="color: #000040;">||</span> op <span style="color: #000080;">==</span> <span style="color: #FF0000;">'C'</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		XOR<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000080;">=</span> cover<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>m <span style="color: #000080;">&lt;</span> R<span style="color: #008000;">)</span> update<span style="color: #008000;">(</span>op , L , R , rson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>op <span style="color: #000080;">==</span> <span style="color: #FF0000;">'I'</span> <span style="color: #000040;">||</span> op <span style="color: #000080;">==</span> <span style="color: #FF0000;">'C'</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		XOR<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #000040;">|</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000080;">=</span> cover<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #000040;">|</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">void</span> query<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> l,<span style="color: #0000ff;">int</span> r,<span style="color: #0000ff;">int</span> rt<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>cover<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">==</span> <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		<span style="color: #0000ff;">for</span> <span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> it <span style="color: #000080;">=</span> l <span style="color: #008080;">;</span> it <span style="color: #000080;">&lt;=</span> r <span style="color: #008080;">;</span> it <span style="color: #000040;">++</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
			hash<span style="color: #008000;">[</span>it<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000ff;">true</span><span style="color: #008080;">;</span>
		<span style="color: #008000;">}</span>
		<span style="color: #0000ff;">return</span> <span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span> <span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>cover<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">==</span> <span style="color: #0000dd;">0</span><span style="color: #008000;">)</span> <span style="color: #0000ff;">return</span> <span style="color: #008080;">;</span>
<span style="color: #666666;">//	if (l == r) return ; // the leaf node never be -1</span>
	PushDown<span style="color: #008000;">(</span>rt<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">int</span> m <span style="color: #000080;">=</span> <span style="color: #008000;">(</span>l <span style="color: #000040;">+</span> r<span style="color: #008000;">)</span> <span style="color: #000080;">&gt;&gt;</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
	query<span style="color: #008000;">(</span>lson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	query<span style="color: #008000;">(</span>rson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">int</span> main<span style="color: #008000;">(</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	cover<span style="color: #008000;">[</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000080;">=</span> XOR<span style="color: #008000;">[</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">char</span> op , l , r<span style="color: #008080;">;</span>
	<span style="color: #0000ff;">int</span> a , b<span style="color: #008080;">;</span>
	<span style="color: #0000ff;">while</span> <span style="color: #008000;">(</span> ~<span style="color: #0000dd;">scanf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%c %c%d,%d%c<span style="color: #000099; font-weight: bold;">\n</span>"</span>,<span style="color: #000040;">&amp;</span>op , <span style="color: #000040;">&amp;</span>l , <span style="color: #000040;">&amp;</span>a , <span style="color: #000040;">&amp;</span>b , <span style="color: #000040;">&amp;</span>r<span style="color: #008000;">)</span> <span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		a <span style="color: #000080;">&lt;&lt;=</span> <span style="color: #0000dd;">1</span> , b <span style="color: #000080;">&lt;&lt;=</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>l <span style="color: #000080;">==</span> <span style="color: #FF0000;">'('</span><span style="color: #008000;">)</span> a <span style="color: #000040;">++</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>r <span style="color: #000080;">==</span> <span style="color: #FF0000;">')'</span><span style="color: #008000;">)</span> b <span style="color: #000040;">--</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>a <span style="color: #000080;">&gt;</span> b<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
			<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>op <span style="color: #000080;">==</span> <span style="color: #FF0000;">'C'</span> <span style="color: #000040;">||</span> op <span style="color: #000080;">==</span> <span style="color: #FF0000;">'I'</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
				cover<span style="color: #008000;">[</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000080;">=</span> XOR<span style="color: #008000;">[</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
			<span style="color: #008000;">}</span>
		<span style="color: #008000;">}</span> <span style="color: #0000ff;">else</span> update<span style="color: #008000;">(</span>op , a , b , <span style="color: #0000dd;">0</span> , maxn , <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span>
	query<span style="color: #008000;">(</span><span style="color: #0000dd;">0</span> , maxn , <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">bool</span> flag <span style="color: #000080;">=</span> <span style="color: #0000ff;">false</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">int</span> s <span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span> , e<span style="color: #008080;">;</span>
	<span style="color: #0000ff;">for</span> <span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> i <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span> <span style="color: #008080;">;</span> i <span style="color: #000080;">&lt;=</span> maxn <span style="color: #008080;">;</span> i <span style="color: #000040;">++</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>hash<span style="color: #008000;">[</span>i<span style="color: #008000;">]</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
			<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>s <span style="color: #000080;">==</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #008000;">)</span> s <span style="color: #000080;">=</span> i<span style="color: #008080;">;</span>
			e <span style="color: #000080;">=</span> i<span style="color: #008080;">;</span>
		<span style="color: #008000;">}</span> <span style="color: #0000ff;">else</span> <span style="color: #008000;">{</span>
			<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>s <span style="color: #000040;">!</span><span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
				<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>flag<span style="color: #008000;">)</span> <span style="color: #0000dd;">printf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">" "</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
				flag <span style="color: #000080;">=</span> <span style="color: #0000ff;">true</span><span style="color: #008080;">;</span>
				<span style="color: #0000dd;">printf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%c%d,%d%c"</span>,s<span style="color: #000040;">&amp;</span><span style="color: #0000dd;">1</span><span style="color: #008080;">?</span><span style="color: #FF0000;">'('</span><span style="color: #008080;">:</span><span style="color: #FF0000;">'['</span> , s<span style="color: #000080;">&gt;&gt;</span><span style="color: #0000dd;">1</span> , <span style="color: #008000;">(</span>e<span style="color: #000040;">+</span><span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #000080;">&gt;&gt;</span><span style="color: #0000dd;">1</span> , e<span style="color: #000040;">&amp;</span><span style="color: #0000dd;">1</span><span style="color: #008080;">?</span><span style="color: #FF0000;">')'</span><span style="color: #008080;">:</span><span style="color: #FF0000;">']'</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
				s <span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
			<span style="color: #008000;">}</span>
		<span style="color: #008000;">}</span>
	<span style="color: #008000;">}</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span><span style="color: #000040;">!</span>flag<span style="color: #008000;">)</span> <span style="color: #0000dd;">printf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"empty set"</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #0000dd;">puts</span><span style="color: #008000;">(</span><span style="color: #FF0000;">""</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">return</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span></pre></td></tr></tbody></table></div>

</li>
<li>练习<br>
<a href="http://poj.org/problem?id=1436">poj1436 Horizontally Visible Segments</a><br>
<a href="http://poj.org/problem?id=2991">poj2991 Crane</a><br>
<a href="http://acm.uestc.edu.cn/problem.php?pid=1425">Another LCIS</a><br>
<a href="http://acm.uestc.edu.cn/problem.php?pid=1546">Bracket Sequence</a> </li>
</ul>
</li>
<li>
<span style="color:#ff0000">区间合并</span><br>
这类题目会询问区间中满足条件的连续最长区间,所以PushUp的时候需要对左右儿子的区间进行合并<p></p>
<ul>
<li>
<a href="http://poj.org/problem?id=3667">poj3667 Hotel</a><br>
题意:1 a:询问是不是有连续长度为a的空房间,有的话住进最左边<br>
     2 a b:将[a,a+b-1]的房间清空<br>
思路:记录区间中最长的空房间<br>
线段树操作:update:区间替换 query:询问满足条件的最左断点<p></p>

<div class="wp_codebox_msgheader wp_codebox_hide active"><span class="right"><sup><a href="http://www.ericbess.com/ericblog/2008/03/03/wp-codebox/#examples" target="_blank" title="WP-CodeBox HowTo?"><span style="color: #99cc00">?</span></a></sup></span><span class="left"><a href="javascript:;" onclick="javascript:showCodeTxt(&#39;p978code9&#39;); return false;">View Code</a> CPP</span><div class="codebox_clear"></div></div><div class="wp_codebox" style="display: none;"><table><tbody><tr id="p9789"><td class="line_numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
</pre></td><td class="code" id="p978code9"><pre class="cpp" style="font-family:monospace;"><span style="color: #339900;">#include &lt;cstdio&gt;</span>
<span style="color: #339900;">#include &lt;cstring&gt;</span>
<span style="color: #339900;">#include &lt;cctype&gt;</span>
<span style="color: #339900;">#include &lt;algorithm&gt;</span>
<span style="color: #0000ff;">using</span> <span style="color: #0000ff;">namespace</span> std<span style="color: #008080;">;</span>
<span style="color: #339900;">#define lson l , m , rt &lt;&lt; 1</span>
<span style="color: #339900;">#define rson m + 1 , r , rt &lt;&lt; 1 | 1</span>
&nbsp;
<span style="color: #0000ff;">const</span> <span style="color: #0000ff;">int</span> maxn <span style="color: #000080;">=</span> <span style="color: #0000dd;">55555</span><span style="color: #008080;">;</span>
<span style="color: #0000ff;">int</span> lsum<span style="color: #008000;">[</span>maxn<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">2</span><span style="color: #008000;">]</span> , rsum<span style="color: #008000;">[</span>maxn<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">2</span><span style="color: #008000;">]</span> , msum<span style="color: #008000;">[</span>maxn<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">2</span><span style="color: #008000;">]</span><span style="color: #008080;">;</span>
<span style="color: #0000ff;">int</span> cover<span style="color: #008000;">[</span>maxn<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">2</span><span style="color: #008000;">]</span><span style="color: #008080;">;</span>
&nbsp;
<span style="color: #0000ff;">void</span> PushDown<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> rt,<span style="color: #0000ff;">int</span> m<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>cover<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000040;">!</span><span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		cover<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000080;">=</span> cover<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #000040;">|</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000080;">=</span> cover<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span><span style="color: #008080;">;</span>
		msum<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000080;">=</span> lsum<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000080;">=</span> rsum<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000080;">=</span> cover<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #008080;">?</span> <span style="color: #0000dd;">0</span> <span style="color: #008080;">:</span> m <span style="color: #000040;">-</span> <span style="color: #008000;">(</span>m <span style="color: #000080;">&gt;&gt;</span> <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		msum<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #000040;">|</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000080;">=</span> lsum<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #000040;">|</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000080;">=</span> rsum<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #000040;">|</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000080;">=</span> cover<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #008080;">?</span> <span style="color: #0000dd;">0</span> <span style="color: #008080;">:</span> <span style="color: #008000;">(</span>m <span style="color: #000080;">&gt;&gt;</span> <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		cover<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">void</span> PushUp<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> rt,<span style="color: #0000ff;">int</span> m<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	lsum<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> lsum<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span><span style="color: #008080;">;</span>
	rsum<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> rsum<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #000040;">|</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>lsum<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">==</span> m <span style="color: #000040;">-</span> <span style="color: #008000;">(</span>m <span style="color: #000080;">&gt;&gt;</span> <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008000;">)</span> lsum<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000040;">+</span><span style="color: #000080;">=</span> lsum<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #000040;">|</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>rsum<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">==</span> <span style="color: #008000;">(</span>m <span style="color: #000080;">&gt;&gt;</span> <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008000;">)</span> rsum<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000040;">+</span><span style="color: #000080;">=</span> rsum<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span><span style="color: #008080;">;</span>
	msum<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> max<span style="color: #008000;">(</span>lsum<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #000040;">|</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000040;">+</span> rsum<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> , max<span style="color: #008000;">(</span>msum<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> , msum<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #000040;">|</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span><span style="color: #008000;">)</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">void</span> build<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> l,<span style="color: #0000ff;">int</span> r,<span style="color: #0000ff;">int</span> rt<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	msum<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> lsum<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> rsum<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> r <span style="color: #000040;">-</span> l <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
	cover<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>l <span style="color: #000080;">==</span> r<span style="color: #008000;">)</span> <span style="color: #0000ff;">return</span> <span style="color: #008080;">;</span>
	<span style="color: #0000ff;">int</span> m <span style="color: #000080;">=</span> <span style="color: #008000;">(</span>l <span style="color: #000040;">+</span> r<span style="color: #008000;">)</span> <span style="color: #000080;">&gt;&gt;</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
	build<span style="color: #008000;">(</span>lson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	build<span style="color: #008000;">(</span>rson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">void</span> update<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> L,<span style="color: #0000ff;">int</span> R,<span style="color: #0000ff;">int</span> c,<span style="color: #0000ff;">int</span> l,<span style="color: #0000ff;">int</span> r,<span style="color: #0000ff;">int</span> rt<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>L <span style="color: #000080;">&lt;=</span> l <span style="color: #000040;">&amp;&amp;</span> r <span style="color: #000080;">&lt;=</span> R<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		msum<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> lsum<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> rsum<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> c <span style="color: #008080;">?</span> <span style="color: #0000dd;">0</span> <span style="color: #008080;">:</span> r <span style="color: #000040;">-</span> l <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
		cover<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> c<span style="color: #008080;">;</span>
		<span style="color: #0000ff;">return</span> <span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span>
	PushDown<span style="color: #008000;">(</span>rt , r <span style="color: #000040;">-</span> l <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">int</span> m <span style="color: #000080;">=</span> <span style="color: #008000;">(</span>l <span style="color: #000040;">+</span> r<span style="color: #008000;">)</span> <span style="color: #000080;">&gt;&gt;</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>L <span style="color: #000080;">&lt;=</span> m<span style="color: #008000;">)</span> update<span style="color: #008000;">(</span>L , R , c , lson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>m <span style="color: #000080;">&lt;</span> R<span style="color: #008000;">)</span> update<span style="color: #008000;">(</span>L , R , c , rson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	PushUp<span style="color: #008000;">(</span>rt , r <span style="color: #000040;">-</span> l <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">int</span> query<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> w,<span style="color: #0000ff;">int</span> l,<span style="color: #0000ff;">int</span> r,<span style="color: #0000ff;">int</span> rt<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>l <span style="color: #000080;">==</span> r<span style="color: #008000;">)</span> <span style="color: #0000ff;">return</span> l<span style="color: #008080;">;</span>
	PushDown<span style="color: #008000;">(</span>rt , r <span style="color: #000040;">-</span> l <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">int</span> m <span style="color: #000080;">=</span> <span style="color: #008000;">(</span>l <span style="color: #000040;">+</span> r<span style="color: #008000;">)</span> <span style="color: #000080;">&gt;&gt;</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>msum<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000080;">&gt;=</span> w<span style="color: #008000;">)</span> <span style="color: #0000ff;">return</span> query<span style="color: #008000;">(</span>w , lson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>rsum<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000040;">+</span> lsum<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #000040;">|</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000080;">&gt;=</span> w<span style="color: #008000;">)</span> <span style="color: #0000ff;">return</span> m <span style="color: #000040;">-</span> rsum<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">return</span> query<span style="color: #008000;">(</span>w , rson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">int</span> main<span style="color: #008000;">(</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">int</span> n , m<span style="color: #008080;">;</span>
	<span style="color: #0000dd;">scanf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%d%d"</span>,<span style="color: #000040;">&amp;</span>n,<span style="color: #000040;">&amp;</span>m<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	build<span style="color: #008000;">(</span><span style="color: #0000dd;">1</span> , n , <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">while</span> <span style="color: #008000;">(</span>m <span style="color: #000040;">--</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		<span style="color: #0000ff;">int</span> op , a , b<span style="color: #008080;">;</span>
		<span style="color: #0000dd;">scanf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%d"</span>,<span style="color: #000040;">&amp;</span>op<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>op <span style="color: #000080;">==</span> <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
			<span style="color: #0000dd;">scanf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%d"</span>,<span style="color: #000040;">&amp;</span>a<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
			<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>msum<span style="color: #008000;">[</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000080;">&lt;</span> a<span style="color: #008000;">)</span> <span style="color: #0000dd;">puts</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"0"</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
			<span style="color: #0000ff;">else</span> <span style="color: #008000;">{</span>
				<span style="color: #0000ff;">int</span> p <span style="color: #000080;">=</span> query<span style="color: #008000;">(</span>a , <span style="color: #0000dd;">1</span> , n , <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
				<span style="color: #0000dd;">printf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%d<span style="color: #000099; font-weight: bold;">\n</span>"</span>,p<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
				update<span style="color: #008000;">(</span>p , p <span style="color: #000040;">+</span> a <span style="color: #000040;">-</span> <span style="color: #0000dd;">1</span> , <span style="color: #0000dd;">1</span> , <span style="color: #0000dd;">1</span> , n , <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
			<span style="color: #008000;">}</span>
		<span style="color: #008000;">}</span> <span style="color: #0000ff;">else</span> <span style="color: #008000;">{</span>
			<span style="color: #0000dd;">scanf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%d%d"</span>,<span style="color: #000040;">&amp;</span>a,<span style="color: #000040;">&amp;</span>b<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
			update<span style="color: #008000;">(</span>a , a <span style="color: #000040;">+</span> b <span style="color: #000040;">-</span> <span style="color: #0000dd;">1</span> , <span style="color: #0000dd;">0</span> , <span style="color: #0000dd;">1</span> , n , <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		<span style="color: #008000;">}</span>
	<span style="color: #008000;">}</span>
	<span style="color: #0000ff;">return</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span></pre></td></tr></tbody></table></div>

</li>
<li>练习<br>
<a href="http://acm.hdu.edu.cn/showproblem.php?pid=3308">hdu3308 LCIS</a><br>
<a href="http://acm.hdu.edu.cn/showproblem.php?pid=3397">hdu3397 Sequence operation</a><br>
<a href="http://acm.hdu.edu.cn/showproblem.php?pid=2871">hdu2871 Memory Control</a><br>
<a href="http://acm.hdu.edu.cn/showproblem.php?pid=1540">hdu1540 Tunnel Warfare</a><br>
<a href="http://www.codeforces.com/problemset/problem/46/D">CF46-D Parking Lot</a></li>
</ul>
</li>
<li>
<span style="color:#ff0000">扫描线</span><br>
这类题目需要将一些操作排序,然后从左到右用一根扫描线(当然是在我们脑子里)扫过去<br>
最典型的就是矩形面积并,周长并等题<p></p>
<ul>
<li>
<a href="http://acm.hdu.edu.cn/showproblem.php?pid=1542">hdu1542 Atlantis</a><br>
题意:矩形面积并<br>
思路:浮点数先要离散化;然后把矩形分成两条边,上边和下边,对横轴建树,然后从下到上扫描上去,用cnt表示该区间下边比上边多几个,sum代表该区间内被覆盖的线段的长度总和<br>
这里线段树的一个结点并非是线段的一个端点,而是该端点和下一个端点间的线段,所以题目中r+1,r-1的地方可以自己好好的琢磨一下<br>
线段树操作:update:区间增减 query:直接取根节点的值<p></p>

<div class="wp_codebox_msgheader wp_codebox_hide active"><span class="right"><sup><a href="http://www.ericbess.com/ericblog/2008/03/03/wp-codebox/#examples" target="_blank" title="WP-CodeBox HowTo?"><span style="color: #99cc00">?</span></a></sup></span><span class="left"><a href="javascript:;" onclick="javascript:showCodeTxt(&#39;p978code10&#39;); return false;">View Code</a> CPP</span><div class="codebox_clear"></div></div><div class="wp_codebox" style="display: none;"><table><tbody><tr id="p97810"><td class="line_numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
</pre></td><td class="code" id="p978code10"><pre class="cpp" style="font-family:monospace;"><span style="color: #339900;">#include &lt;cstdio&gt;</span>
<span style="color: #339900;">#include &lt;cstring&gt;</span>
<span style="color: #339900;">#include &lt;cctype&gt;</span>
<span style="color: #339900;">#include &lt;algorithm&gt;</span>
<span style="color: #0000ff;">using</span> <span style="color: #0000ff;">namespace</span> std<span style="color: #008080;">;</span>
<span style="color: #339900;">#define lson l , m , rt &lt;&lt; 1</span>
<span style="color: #339900;">#define rson m + 1 , r , rt &lt;&lt; 1 | 1</span>
&nbsp;
<span style="color: #0000ff;">const</span> <span style="color: #0000ff;">int</span> maxn <span style="color: #000080;">=</span> <span style="color: #0000dd;">2222</span><span style="color: #008080;">;</span>
<span style="color: #0000ff;">int</span> cnt<span style="color: #008000;">[</span>maxn <span style="color: #000080;">&lt;&lt;</span> <span style="color: #0000dd;">2</span><span style="color: #008000;">]</span><span style="color: #008080;">;</span>
<span style="color: #0000ff;">double</span> sum<span style="color: #008000;">[</span>maxn <span style="color: #000080;">&lt;&lt;</span> <span style="color: #0000dd;">2</span><span style="color: #008000;">]</span><span style="color: #008080;">;</span>
<span style="color: #0000ff;">double</span> X<span style="color: #008000;">[</span>maxn<span style="color: #008000;">]</span><span style="color: #008080;">;</span>
<span style="color: #0000ff;">struct</span> Seg <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">double</span> h , l , r<span style="color: #008080;">;</span>
	<span style="color: #0000ff;">int</span> s<span style="color: #008080;">;</span>
	Seg<span style="color: #008000;">(</span><span style="color: #008000;">)</span><span style="color: #008000;">{</span><span style="color: #008000;">}</span>
	Seg<span style="color: #008000;">(</span><span style="color: #0000ff;">double</span> a,<span style="color: #0000ff;">double</span> b,<span style="color: #0000ff;">double</span> c,<span style="color: #0000ff;">int</span> d<span style="color: #008000;">)</span> <span style="color: #008080;">:</span> l<span style="color: #008000;">(</span>a<span style="color: #008000;">)</span> , r<span style="color: #008000;">(</span>b<span style="color: #008000;">)</span> , h<span style="color: #008000;">(</span>c<span style="color: #008000;">)</span> , s<span style="color: #008000;">(</span>d<span style="color: #008000;">)</span> <span style="color: #008000;">{</span><span style="color: #008000;">}</span>
	<span style="color: #0000ff;">bool</span> operator <span style="color: #000080;">&lt;</span> <span style="color: #008000;">(</span><span style="color: #0000ff;">const</span> Seg <span style="color: #000040;">&amp;</span>cmp<span style="color: #008000;">)</span> <span style="color: #0000ff;">const</span> <span style="color: #008000;">{</span>
		<span style="color: #0000ff;">return</span> h <span style="color: #000080;">&lt;</span> cmp.<span style="color: #007788;">h</span><span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span>
<span style="color: #008000;">}</span>ss<span style="color: #008000;">[</span>maxn<span style="color: #008000;">]</span><span style="color: #008080;">;</span>
<span style="color: #0000ff;">void</span> PushUp<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> rt,<span style="color: #0000ff;">int</span> l,<span style="color: #0000ff;">int</span> r<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>cnt<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span><span style="color: #008000;">)</span> sum<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> X<span style="color: #008000;">[</span>r<span style="color: #000040;">+</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000040;">-</span> X<span style="color: #008000;">[</span>l<span style="color: #008000;">]</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>l <span style="color: #000080;">==</span> r<span style="color: #008000;">)</span> sum<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">else</span> sum<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> sum<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000040;">+</span> sum<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #000040;">|</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">void</span> update<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> L,<span style="color: #0000ff;">int</span> R,<span style="color: #0000ff;">int</span> c,<span style="color: #0000ff;">int</span> l,<span style="color: #0000ff;">int</span> r,<span style="color: #0000ff;">int</span> rt<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>L <span style="color: #000080;">&lt;=</span> l <span style="color: #000040;">&amp;&amp;</span> r <span style="color: #000080;">&lt;=</span> R<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		cnt<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000040;">+</span><span style="color: #000080;">=</span> c<span style="color: #008080;">;</span>
		PushUp<span style="color: #008000;">(</span>rt , l , r<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">return</span> <span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span>
	<span style="color: #0000ff;">int</span> m <span style="color: #000080;">=</span> <span style="color: #008000;">(</span>l <span style="color: #000040;">+</span> r<span style="color: #008000;">)</span> <span style="color: #000080;">&gt;&gt;</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>L <span style="color: #000080;">&lt;=</span> m<span style="color: #008000;">)</span> update<span style="color: #008000;">(</span>L , R , c , lson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>m <span style="color: #000080;">&lt;</span> R<span style="color: #008000;">)</span> update<span style="color: #008000;">(</span>L , R , c , rson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	PushUp<span style="color: #008000;">(</span>rt , l , r<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">int</span> Bin<span style="color: #008000;">(</span><span style="color: #0000ff;">double</span> key,<span style="color: #0000ff;">int</span> n,<span style="color: #0000ff;">double</span> X<span style="color: #008000;">[</span><span style="color: #008000;">]</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">int</span> l <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span> , r <span style="color: #000080;">=</span> n <span style="color: #000040;">-</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">while</span> <span style="color: #008000;">(</span>l <span style="color: #000080;">&lt;=</span> r<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		<span style="color: #0000ff;">int</span> m <span style="color: #000080;">=</span> <span style="color: #008000;">(</span>l <span style="color: #000040;">+</span> r<span style="color: #008000;">)</span> <span style="color: #000080;">&gt;&gt;</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>X<span style="color: #008000;">[</span>m<span style="color: #008000;">]</span> <span style="color: #000080;">==</span> key<span style="color: #008000;">)</span> <span style="color: #0000ff;">return</span> m<span style="color: #008080;">;</span>
		<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>X<span style="color: #008000;">[</span>m<span style="color: #008000;">]</span> <span style="color: #000080;">&lt;</span> key<span style="color: #008000;">)</span> l <span style="color: #000080;">=</span> m <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">else</span> r <span style="color: #000080;">=</span> m <span style="color: #000040;">-</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span>
	<span style="color: #0000ff;">return</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">int</span> main<span style="color: #008000;">(</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">int</span> n , cas <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">while</span> <span style="color: #008000;">(</span>~<span style="color: #0000dd;">scanf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%d"</span>,<span style="color: #000040;">&amp;</span>n<span style="color: #008000;">)</span> <span style="color: #000040;">&amp;&amp;</span> n<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		<span style="color: #0000ff;">int</span> m <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">while</span> <span style="color: #008000;">(</span>n <span style="color: #000040;">--</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
			<span style="color: #0000ff;">double</span> a , b , c , d<span style="color: #008080;">;</span>
			<span style="color: #0000dd;">scanf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%lf%lf%lf%lf"</span>,<span style="color: #000040;">&amp;</span>a,<span style="color: #000040;">&amp;</span>b,<span style="color: #000040;">&amp;</span>c,<span style="color: #000040;">&amp;</span>d<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
			X<span style="color: #008000;">[</span>m<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> a<span style="color: #008080;">;</span>
			ss<span style="color: #008000;">[</span>m<span style="color: #000040;">++</span><span style="color: #008000;">]</span> <span style="color: #000080;">=</span> Seg<span style="color: #008000;">(</span>a , c , b , <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
			X<span style="color: #008000;">[</span>m<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> c<span style="color: #008080;">;</span>
			ss<span style="color: #008000;">[</span>m<span style="color: #000040;">++</span><span style="color: #008000;">]</span> <span style="color: #000080;">=</span> Seg<span style="color: #008000;">(</span>a , c , d , <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		<span style="color: #008000;">}</span>
		sort<span style="color: #008000;">(</span>X , X <span style="color: #000040;">+</span> m<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		sort<span style="color: #008000;">(</span>ss , ss <span style="color: #000040;">+</span> m<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">int</span> k <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">for</span> <span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> i <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span> <span style="color: #008080;">;</span> i <span style="color: #000080;">&lt;</span> m <span style="color: #008080;">;</span> i <span style="color: #000040;">++</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
			<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>X<span style="color: #008000;">[</span>i<span style="color: #008000;">]</span> <span style="color: #000040;">!</span><span style="color: #000080;">=</span> X<span style="color: #008000;">[</span>i<span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span><span style="color: #008000;">)</span> X<span style="color: #008000;">[</span>k<span style="color: #000040;">++</span><span style="color: #008000;">]</span> <span style="color: #000080;">=</span> X<span style="color: #008000;">[</span>i<span style="color: #008000;">]</span><span style="color: #008080;">;</span>
		<span style="color: #008000;">}</span>
		<span style="color: #0000dd;">memset</span><span style="color: #008000;">(</span>cnt , <span style="color: #0000dd;">0</span> , <span style="color: #0000dd;">sizeof</span><span style="color: #008000;">(</span>cnt<span style="color: #008000;">)</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		<span style="color: #0000dd;">memset</span><span style="color: #008000;">(</span>sum , <span style="color: #0000dd;">0</span> , <span style="color: #0000dd;">sizeof</span><span style="color: #008000;">(</span>sum<span style="color: #008000;">)</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">double</span> ret <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">for</span> <span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> i <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span> <span style="color: #008080;">;</span> i <span style="color: #000080;">&lt;</span> m <span style="color: #000040;">-</span> <span style="color: #0000dd;">1</span> <span style="color: #008080;">;</span> i <span style="color: #000040;">++</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
			<span style="color: #0000ff;">int</span> l <span style="color: #000080;">=</span> Bin<span style="color: #008000;">(</span>ss<span style="color: #008000;">[</span>i<span style="color: #008000;">]</span>.<span style="color: #007788;">l</span> , k , X<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
			<span style="color: #0000ff;">int</span> r <span style="color: #000080;">=</span> Bin<span style="color: #008000;">(</span>ss<span style="color: #008000;">[</span>i<span style="color: #008000;">]</span>.<span style="color: #007788;">r</span> , k , X<span style="color: #008000;">)</span> <span style="color: #000040;">-</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
			<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>l <span style="color: #000080;">&lt;=</span> r<span style="color: #008000;">)</span> update<span style="color: #008000;">(</span>l , r , ss<span style="color: #008000;">[</span>i<span style="color: #008000;">]</span>.<span style="color: #007788;">s</span> , <span style="color: #0000dd;">0</span> , k <span style="color: #000040;">-</span> <span style="color: #0000dd;">1</span>, <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
			ret <span style="color: #000040;">+</span><span style="color: #000080;">=</span> sum<span style="color: #008000;">[</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000040;">*</span> <span style="color: #008000;">(</span>ss<span style="color: #008000;">[</span>i<span style="color: #000040;">+</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span>.<span style="color: #007788;">h</span> <span style="color: #000040;">-</span> ss<span style="color: #008000;">[</span>i<span style="color: #008000;">]</span>.<span style="color: #007788;">h</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		<span style="color: #008000;">}</span>
		<span style="color: #0000dd;">printf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"Test case #%d<span style="color: #000099; font-weight: bold;">\n</span>Total explored area: %.2lf<span style="color: #000099; font-weight: bold;">\n</span><span style="color: #000099; font-weight: bold;">\n</span>"</span>,cas<span style="color: #000040;">++</span> , ret<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span>
	<span style="color: #0000ff;">return</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span></pre></td></tr></tbody></table></div>

</li>
<li>
<a href="http://acm.hdu.edu.cn/showproblem.php?pid=1828">hdu1828 Picture</a><br>
题意:矩形周长并<br>
思路:与面积不同的地方是还要记录竖的边有几个(numseg记录),并且当边界重合的时候需要合并(用lbd和rbd表示边界来辅助)<br>
线段树操作:update:区间增减 query:直接取根节点的值<p></p>

<div class="wp_codebox_msgheader wp_codebox_hide active"><span class="right"><sup><a href="http://www.ericbess.com/ericblog/2008/03/03/wp-codebox/#examples" target="_blank" title="WP-CodeBox HowTo?"><span style="color: #99cc00">?</span></a></sup></span><span class="left"><a href="javascript:;" onclick="javascript:showCodeTxt(&#39;p978code11&#39;); return false;">View Code</a> CPP</span><div class="codebox_clear"></div></div><div class="wp_codebox" style="display: none;"><table><tbody><tr id="p97811"><td class="line_numbers"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
</pre></td><td class="code" id="p978code11"><pre class="cpp" style="font-family:monospace;"><span style="color: #339900;">#include &lt;cstdio&gt;</span>
<span style="color: #339900;">#include &lt;cstring&gt;</span>
<span style="color: #339900;">#include &lt;cctype&gt;</span>
<span style="color: #339900;">#include &lt;algorithm&gt;</span>
<span style="color: #0000ff;">using</span> <span style="color: #0000ff;">namespace</span> std<span style="color: #008080;">;</span>
<span style="color: #339900;">#define lson l , m , rt &lt;&lt; 1</span>
<span style="color: #339900;">#define rson m + 1 , r , rt &lt;&lt; 1 | 1</span>
&nbsp;
<span style="color: #0000ff;">const</span> <span style="color: #0000ff;">int</span> maxn <span style="color: #000080;">=</span> <span style="color: #0000dd;">22222</span><span style="color: #008080;">;</span>
<span style="color: #0000ff;">struct</span> Seg<span style="color: #008000;">{</span>
	<span style="color: #0000ff;">int</span> l , r , h , s<span style="color: #008080;">;</span>
	Seg<span style="color: #008000;">(</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span><span style="color: #008000;">}</span>
	Seg<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> a,<span style="color: #0000ff;">int</span> b,<span style="color: #0000ff;">int</span> c,<span style="color: #0000ff;">int</span> d<span style="color: #008000;">)</span><span style="color: #008080;">:</span>l<span style="color: #008000;">(</span>a<span style="color: #008000;">)</span> , r<span style="color: #008000;">(</span>b<span style="color: #008000;">)</span> , h<span style="color: #008000;">(</span>c<span style="color: #008000;">)</span> , s<span style="color: #008000;">(</span>d<span style="color: #008000;">)</span> <span style="color: #008000;">{</span><span style="color: #008000;">}</span>
	<span style="color: #0000ff;">bool</span> operator <span style="color: #000080;">&lt;</span> <span style="color: #008000;">(</span><span style="color: #0000ff;">const</span> Seg <span style="color: #000040;">&amp;</span>cmp<span style="color: #008000;">)</span> <span style="color: #0000ff;">const</span> <span style="color: #008000;">{</span>
		<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>h <span style="color: #000080;">==</span> cmp.<span style="color: #007788;">h</span><span style="color: #008000;">)</span> <span style="color: #0000ff;">return</span> s <span style="color: #000080;">&gt;</span> cmp.<span style="color: #007788;">s</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">return</span> h <span style="color: #000080;">&lt;</span> cmp.<span style="color: #007788;">h</span><span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span>
<span style="color: #008000;">}</span>ss<span style="color: #008000;">[</span>maxn<span style="color: #008000;">]</span><span style="color: #008080;">;</span>
<span style="color: #0000ff;">bool</span> lbd<span style="color: #008000;">[</span>maxn<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">2</span><span style="color: #008000;">]</span> , rbd<span style="color: #008000;">[</span>maxn<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">2</span><span style="color: #008000;">]</span><span style="color: #008080;">;</span>
<span style="color: #0000ff;">int</span> numseg<span style="color: #008000;">[</span>maxn<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">2</span><span style="color: #008000;">]</span><span style="color: #008080;">;</span>
<span style="color: #0000ff;">int</span> cnt<span style="color: #008000;">[</span>maxn<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">2</span><span style="color: #008000;">]</span><span style="color: #008080;">;</span>
<span style="color: #0000ff;">int</span> len<span style="color: #008000;">[</span>maxn<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">2</span><span style="color: #008000;">]</span><span style="color: #008080;">;</span>
<span style="color: #0000ff;">void</span> PushUP<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> rt,<span style="color: #0000ff;">int</span> l,<span style="color: #0000ff;">int</span> r<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>cnt<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		lbd<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> rbd<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
		len<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> r <span style="color: #000040;">-</span> l <span style="color: #000040;">+</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
		numseg<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span><span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span> <span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>l <span style="color: #000080;">==</span> r<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		len<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> numseg<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> lbd<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> rbd<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span> <span style="color: #0000ff;">else</span> <span style="color: #008000;">{</span>
		lbd<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> lbd<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span><span style="color: #008080;">;</span>
		rbd<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> rbd<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #000040;">|</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span><span style="color: #008080;">;</span>
		len<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> len<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000040;">+</span> len<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #000040;">|</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span><span style="color: #008080;">;</span>
		numseg<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000080;">=</span> numseg<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000040;">+</span> numseg<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #000040;">|</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>lbd<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #000040;">|</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000040;">&amp;&amp;</span> rbd<span style="color: #008000;">[</span>rt<span style="color: #000080;">&lt;&lt;</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span><span style="color: #008000;">)</span> numseg<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000040;">-</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">2</span><span style="color: #008080;">;</span><span style="color: #666666;">//两条线重合</span>
	<span style="color: #008000;">}</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">void</span> update<span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> L,<span style="color: #0000ff;">int</span> R,<span style="color: #0000ff;">int</span> c,<span style="color: #0000ff;">int</span> l,<span style="color: #0000ff;">int</span> r,<span style="color: #0000ff;">int</span> rt<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>L <span style="color: #000080;">&lt;=</span> l <span style="color: #000040;">&amp;&amp;</span> r <span style="color: #000080;">&lt;=</span> R<span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		cnt<span style="color: #008000;">[</span>rt<span style="color: #008000;">]</span> <span style="color: #000040;">+</span><span style="color: #000080;">=</span> c<span style="color: #008080;">;</span>
		PushUP<span style="color: #008000;">(</span>rt , l , r<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">return</span> <span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span>
	<span style="color: #0000ff;">int</span> m <span style="color: #000080;">=</span> <span style="color: #008000;">(</span>l <span style="color: #000040;">+</span> r<span style="color: #008000;">)</span> <span style="color: #000080;">&gt;&gt;</span> <span style="color: #0000dd;">1</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>L <span style="color: #000080;">&lt;=</span> m<span style="color: #008000;">)</span> update<span style="color: #008000;">(</span>L , R , c , lson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>m <span style="color: #000080;">&lt;</span> R<span style="color: #008000;">)</span> update<span style="color: #008000;">(</span>L , R , c , rson<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	PushUP<span style="color: #008000;">(</span>rt , l , r<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span>
<span style="color: #0000ff;">int</span> main<span style="color: #008000;">(</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
	<span style="color: #0000ff;">int</span> n<span style="color: #008080;">;</span>
	<span style="color: #0000ff;">while</span> <span style="color: #008000;">(</span>~<span style="color: #0000dd;">scanf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%d"</span>,<span style="color: #000040;">&amp;</span>n<span style="color: #008000;">)</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
		<span style="color: #0000ff;">int</span> m <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">int</span> lbd <span style="color: #000080;">=</span> <span style="color: #0000dd;">10000</span>, rbd <span style="color: #000080;">=</span> <span style="color: #000040;">-</span><span style="color: #0000dd;">10000</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">for</span> <span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> i <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span> <span style="color: #008080;">;</span> i <span style="color: #000080;">&lt;</span> n <span style="color: #008080;">;</span> i <span style="color: #000040;">++</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
			<span style="color: #0000ff;">int</span> a , b , c , d<span style="color: #008080;">;</span>
			<span style="color: #0000dd;">scanf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%d%d%d%d"</span>,<span style="color: #000040;">&amp;</span>a,<span style="color: #000040;">&amp;</span>b,<span style="color: #000040;">&amp;</span>c,<span style="color: #000040;">&amp;</span>d<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
			lbd <span style="color: #000080;">=</span> min<span style="color: #008000;">(</span>lbd , a<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
			rbd <span style="color: #000080;">=</span> max<span style="color: #008000;">(</span>rbd , c<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
			ss<span style="color: #008000;">[</span>m<span style="color: #000040;">++</span><span style="color: #008000;">]</span> <span style="color: #000080;">=</span> Seg<span style="color: #008000;">(</span>a , c , b , <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
			ss<span style="color: #008000;">[</span>m<span style="color: #000040;">++</span><span style="color: #008000;">]</span> <span style="color: #000080;">=</span> Seg<span style="color: #008000;">(</span>a , c , d , <span style="color: #000040;">-</span><span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		<span style="color: #008000;">}</span>
		sort<span style="color: #008000;">(</span>ss , ss <span style="color: #000040;">+</span> m<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">int</span> ret <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span> , last <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
		<span style="color: #0000ff;">for</span> <span style="color: #008000;">(</span><span style="color: #0000ff;">int</span> i <span style="color: #000080;">=</span> <span style="color: #0000dd;">0</span> <span style="color: #008080;">;</span> i <span style="color: #000080;">&lt;</span> m <span style="color: #008080;">;</span> i <span style="color: #000040;">++</span><span style="color: #008000;">)</span> <span style="color: #008000;">{</span>
			<span style="color: #0000ff;">if</span> <span style="color: #008000;">(</span>ss<span style="color: #008000;">[</span>i<span style="color: #008000;">]</span>.<span style="color: #007788;">l</span> <span style="color: #000080;">&lt;</span> ss<span style="color: #008000;">[</span>i<span style="color: #008000;">]</span>.<span style="color: #007788;">r</span><span style="color: #008000;">)</span> update<span style="color: #008000;">(</span>ss<span style="color: #008000;">[</span>i<span style="color: #008000;">]</span>.<span style="color: #007788;">l</span> , ss<span style="color: #008000;">[</span>i<span style="color: #008000;">]</span>.<span style="color: #007788;">r</span> <span style="color: #000040;">-</span> <span style="color: #0000dd;">1</span> , ss<span style="color: #008000;">[</span>i<span style="color: #008000;">]</span>.<span style="color: #007788;">s</span> , lbd , rbd <span style="color: #000040;">-</span> <span style="color: #0000dd;">1</span> , <span style="color: #0000dd;">1</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
			ret <span style="color: #000040;">+</span><span style="color: #000080;">=</span> numseg<span style="color: #008000;">[</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000040;">*</span> <span style="color: #008000;">(</span>ss<span style="color: #008000;">[</span>i<span style="color: #000040;">+</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span>.<span style="color: #007788;">h</span> <span style="color: #000040;">-</span> ss<span style="color: #008000;">[</span>i<span style="color: #008000;">]</span>.<span style="color: #007788;">h</span><span style="color: #008000;">)</span><span style="color: #008080;">;</span>
			ret <span style="color: #000040;">+</span><span style="color: #000080;">=</span> <span style="color: #0000dd;">abs</span><span style="color: #008000;">(</span>len<span style="color: #008000;">[</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span> <span style="color: #000040;">-</span> last<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
			last <span style="color: #000080;">=</span> len<span style="color: #008000;">[</span><span style="color: #0000dd;">1</span><span style="color: #008000;">]</span><span style="color: #008080;">;</span>
		<span style="color: #008000;">}</span>
		<span style="color: #0000dd;">printf</span><span style="color: #008000;">(</span><span style="color: #FF0000;">"%d<span style="color: #000099; font-weight: bold;">\n</span>"</span>,ret<span style="color: #008000;">)</span><span style="color: #008080;">;</span>
	<span style="color: #008000;">}</span>
	<span style="color: #0000ff;">return</span> <span style="color: #0000dd;">0</span><span style="color: #008080;">;</span>
<span style="color: #008000;">}</span></pre></td></tr></tbody></table></div>

</li>
<li>练习<br>
<a href="http://acm.hdu.edu.cn/showproblem.php?pid=3265">hdu3265 Posters</a><br>
<a href="http://acm.hdu.edu.cn/showproblem.php?pid=3642">hdu3642 Get The Treasury</a><br>
<a href="http://poj.org/problem?id=2482">poj2482 Stars in Your Window</a><br>
<a href="http://poj.org/problem?id=2464">poj2464 Brownie Points II</a><br>
<a href="http://acm.hdu.edu.cn/showproblem.php?pid=3255">hdu3255 Farming </a><br>
<a href="http://acm.timus.ru/problem.aspx?space=1&num=1707">ural1707 Hypnotoad's Secret</a><br>
<a href="http://uva.onlinejudge.org/index.php?option=com_onlinejudge&Itemid=8&category=229&page=show_problem&problem=3134">uva11983 Weird Advertisement</a>
</li>
</ul>
</li>
</ul>
<p>线段树与其他结合练习(欢迎大家补充):</p>
<ul>
<li> <a href="http://acm.hdu.edu.cn/showproblem.php?pid=3954">hdu3954 Level up</a> </li>
<li> <a href="http://acm.hdu.edu.cn/showproblem.php?pid=4027">hdu4027 Can you answer these queries?</a> </li>
<li> <a href="http://acm.hdu.edu.cn/showproblem.php?pid=3333">hdu3333 Turing Tree</a> </li>
<li> <a href="http://acm.hdu.edu.cn/showproblem.php?pid=3874">hdu3874 Necklace</a> </li>
<li> <a href="http://acm.hdu.edu.cn/showproblem.php?pid=3016">hdu3016 Man Down</a> </li>
<li> <a href="http://acm.hdu.edu.cn/showproblem.php?pid=3340">hdu3340 Rain in ACStar</a> </li>
<li> <a href="http://acm.zju.edu.cn/onlinejudge/showProblem.do?problemCode=3511">zju3511 Cake Robbery</a> </li>
<li> <a href="http://acm.uestc.edu.cn/problem.php?pid=1558">UESTC1558 Charitable Exchange</a> </li>
<li> <a href="http://www.codeforces.com/problemset/problem/85/D">CF85-D Sum of Medians</a> </li>
<li> <a href="http://www.spoj.pl/problems/GSS2/">spojGSS2 Can you answer these queries II</a> </li>
</ul>
            </div>

            
            

            
            <div class="post-meta">

              <div class="details">
                <p>
                This entry was posted by <a href="http://www.notonlysuccess.com/index.php/author/admin/" title="Posts by shǎ崽 ">shǎ崽</a> on 2011/07/25 at 12:54, and is filed under <a href="http://www.notonlysuccess.com/index.php/category/acm/" title="查看ACM中的全部文章" rel="category tag">ACM</a>. Follow any responses to this post through <a href="http://www.notonlysuccess.com/index.php/segment-tree-complete/feed/" title="RSS 2.0">RSS 2.0</a>.
                You can <a href="http://www.notonlysuccess.com/index.php/segment-tree-complete/#commentform">leave a response</a> or <a href="http://www.notonlysuccess.com/index.php/segment-tree-complete/trackback/" rel="trackback">trackback</a> from your own site.                </p>
               </div>

            </div>
            
            <div class="controls">
                          </div>

          </div>
          <!-- /post -->

          
          

<h3 class="title">
  206 comments</h3>

<ul id="comments">
  
<!-- comment entry -->
<li>
  <div id="comment-5417" class="comment even thread-even depth-1 clear-block with-avatars reader name-%e5%8c%bf%e5%90%8d">

        <div class="avatar">
      <img alt="" src="./NotOnlySuccess   【完全版】线段树_files/saved_resource" class="avatar avatar-48 photo avatar-default" height="48" width="48">    </div>
    
    <div class="comment-head">
      <div class="ext clear-block">
        <span class="a">匿名</span> <span class="d">(4周)</span>       </div>
    </div>

    <div class="comment-body" id="comment-body-5417">
       <div class="comment-content clear-block" id="comment-content-5417">

         
         <div class="comment-text">
           <p>膜拜大神</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,5417,1,&#39;&#39;);">回复</a>]</p>         </div>

         <a id="comment-reply-5417"></a>
       </div>

       <div class="controls">
                  <a class="comment-reply-link" href="http://www.notonlysuccess.com/index.php/segment-tree-complete/?replytocom=5417#respond" onclick="return addComment.moveForm(&quot;comment-content-5417&quot;, &quot;5417&quot;, &quot;respond&quot;, &quot;978&quot;)">Reply <span>↓</span></a>       </div>

    </div>

  </div>
</li><!-- #comment-## -->

<!-- comment entry -->
<li>
  <div id="comment-5411" class="comment odd alt thread-odd thread-alt depth-1 clear-block with-avatars reader name-australia-business-database-list">

        <div class="avatar">
      <img alt="" src="./NotOnlySuccess   【完全版】线段树_files/62cfc5bc5e31e0ce5f707f61a24a04ca" class="avatar avatar-48 photo" height="48" width="48">    </div>
    
    <div class="comment-head">
      <div class="ext clear-block">
        <span class="a"><a href="http://www.youtube.com/watch?v=-HXH-m7DuI0" rel="external nofollow" class="url">Australia business database list</a></span> <span class="d">(2月)</span>       </div>
    </div>

    <div class="comment-body" id="comment-body-5411">
       <div class="comment-content clear-block" id="comment-content-5411">

         
         <div class="comment-text">
           <p>Why people still make usе of to read news papers ѡhen iin tɦis technologicaal globe<br>
аll is аvailable on web?</p>
<p>My website; <a href="http://www.youtube.com/watch?v=-HXH-m7DuI0" rel="nofollow">Australia business database list</a><br>
<span class="cluv">Australia business database list´s last [type] ..<a class="b827caceb3 5411" rel="nofollow" href="http://www.youtube.com/watch?v=-HXH-m7DuI0">Australia business database list</a></span></p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,5411,1,&#39;Australia business database list&#39;);">回复</a>]</p>         </div>

         <a id="comment-reply-5411"></a>
       </div>

       <div class="controls">
                  <a class="comment-reply-link" href="http://www.notonlysuccess.com/index.php/segment-tree-complete/?replytocom=5411#respond" onclick="return addComment.moveForm(&quot;comment-content-5411&quot;, &quot;5411&quot;, &quot;respond&quot;, &quot;978&quot;)">Reply <span>↓</span></a>       </div>

    </div>

  </div>
</li><!-- #comment-## -->

<!-- comment entry -->
<li>
  <div id="comment-5337" class="pingback even thread-even depth-1 clear-block with-avatars reader name-%e7%ba%bf%e6%ae%b5%e6%a0%91%e7%bb%83%e4%b9%a0_%e5%85%a5%e9%97%a8-%e7%bc%96%e7%a8%8b-%e5%bc%80%e5%8f%91%e8%80%85">

        <div class="avatar">
          </div>
    
    <div class="comment-head">
      <div class="ext clear-block">
        <span class="a"><a href="http://www.kaifazhe.com/programming/390781.html" rel="external nofollow" class="url">线段树练习_入门 - 编程 - 开发者</a></span> <span class="d">(6月)</span>       </div>
    </div>

    <div class="comment-body" id="comment-body-5337">
       <div class="comment-content clear-block" id="comment-content-5337">

         
         <div class="comment-text">
           <p>[…] 学习资源：nutonlysuccess […]</p>
         </div>

         <a id="comment-reply-5337"></a>
       </div>

       <div class="controls">
                  <a class="comment-reply-link" href="http://www.notonlysuccess.com/index.php/segment-tree-complete/?replytocom=5337#respond" onclick="return addComment.moveForm(&quot;comment-content-5337&quot;, &quot;5337&quot;, &quot;respond&quot;, &quot;978&quot;)">Reply <span>↓</span></a>       </div>

    </div>

  </div>
</li><!-- #comment-## -->

<!-- comment entry -->
<li>
  <div id="comment-5336" class="pingback odd alt thread-odd thread-alt depth-1 clear-block with-avatars reader name-ac%e7%9a%84%e7%ac%ac%e4%b8%80%e4%b8%aa%e7%ba%bf%e6%ae%b5%e6%a0%91-hdu1166-%e6%95%8c%e5%85%b5%e5%b8%83%e9%98%b5">

        <div class="avatar">
          </div>
    
    <div class="comment-head">
      <div class="ext clear-block">
        <span class="a"><a href="http://energycen.com/2012/07/23/ac%e7%9a%84%e7%ac%ac%e4%b8%80%e4%b8%aa%e7%ba%bf%e6%ae%b5%e6%a0%91-hdu1166-%e6%95%8c%e5%85%b5%e5%b8%83%e9%98%b5/" rel="external nofollow" class="url">AC的第一个线段树 HDU1166 敌兵布阵</a></span> <span class="d">(6月)</span>       </div>
    </div>

    <div class="comment-body" id="comment-body-5336">
       <div class="comment-content clear-block" id="comment-content-5336">

         
         <div class="comment-text">
           <p>[…] 线段树可以看成是完全二叉树（可能有些节点下没了子节点破坏了整体的结构，但是在数组的处理时，还是可以当做完全二叉树，因此rt的左儿子就是rt&lt;&lt;1右儿子就是(rt&lt;&lt;1)+1）这么做比存一个结构体然后记录左右儿子的下标要节省空间……是看了notonlysuccess的线段树完整版之后才知道能这么办的，膜拜一下大神 […]</p>
         </div>

         <a id="comment-reply-5336"></a>
       </div>

       <div class="controls">
                  <a class="comment-reply-link" href="http://www.notonlysuccess.com/index.php/segment-tree-complete/?replytocom=5336#respond" onclick="return addComment.moveForm(&quot;comment-content-5336&quot;, &quot;5336&quot;, &quot;respond&quot;, &quot;978&quot;)">Reply <span>↓</span></a>       </div>

    </div>

  </div>
</li><!-- #comment-## -->

<!-- comment entry -->
<li>
  <div id="comment-5335" class="pingback even thread-even depth-1 clear-block with-avatars reader name-poj-3225-help-with-intervals-%e7%ba%bf%e6%ae%b5%e6%a0%91-%e9%9b%86%e5%90%88%e7%9a%84%e4%ba%a4%e5%b9%b6%e5%b7%ae%e8%a1%a5%e8%bf%90%e7%ae%97">

        <div class="avatar">
          </div>
    
    <div class="comment-head">
      <div class="ext clear-block">
        <span class="a"><a href="http://energycen.com/2012/07/25/poj-3225-help-with-intervals-%e7%ba%bf%e6%ae%b5%e6%a0%91-%e9%9b%86%e5%90%88%e7%9a%84%e4%ba%a4%e5%b9%b6%e5%b7%ae%e8%a1%a5%e8%bf%90%e7%ae%97/" rel="external nofollow" class="url">poj 3225 Help with Intervals 线段树 集合的交并差补运算</a></span> <span class="d">(6月)</span>       </div>
    </div>

    <div class="comment-body" id="comment-body-5335">
       <div class="comment-content clear-block" id="comment-content-5335">

         
         <div class="comment-text">
           <p>[…] 首先，如何简单处理开区间和闭区间的问题？我是看了notonlysuccess大神的方法才知道的 […]</p>
         </div>

         <a id="comment-reply-5335"></a>
       </div>

       <div class="controls">
                  <a class="comment-reply-link" href="http://www.notonlysuccess.com/index.php/segment-tree-complete/?replytocom=5335#respond" onclick="return addComment.moveForm(&quot;comment-content-5335&quot;, &quot;5335&quot;, &quot;respond&quot;, &quot;978&quot;)">Reply <span>↓</span></a>       </div>

    </div>

  </div>
</li><!-- #comment-## -->

<!-- comment entry -->
<li>
  <div id="comment-5334" class="pingback odd alt thread-odd thread-alt depth-1 clear-block with-avatars reader name-ac%e7%9a%84%e7%ac%ac%e4%b8%80%e4%b8%aa%e7%ba%bf%e6%ae%b5%e6%a0%91-hdu1166-%e6%95%8c%e5%85%b5%e5%b8%83%e9%98%b5-%e7%8b%ac%e4%b9%90">

        <div class="avatar">
          </div>
    
    <div class="comment-head">
      <div class="ext clear-block">
        <span class="a"><a href="http://www.energycen.com/2012/07/23/ac%e7%9a%84%e7%ac%ac%e4%b8%80%e4%b8%aa%e7%ba%bf%e6%ae%b5%e6%a0%91-hdu1166-%e6%95%8c%e5%85%b5%e5%b8%83%e9%98%b5/" rel="external nofollow" class="url">AC的第一个线段树 HDU1166 敌兵布阵 | 独乐</a></span> <span class="d">(6月)</span>       </div>
    </div>

    <div class="comment-body" id="comment-body-5334">
       <div class="comment-content clear-block" id="comment-content-5334">

         
         <div class="comment-text">
           <p>[…] 线段树可以看成是完全二叉树（可能有些节点下没了子节点破坏了整体的结构，但是在数组的处理时，还是可以当做完全二叉树，因此rt的左儿子就是rt&lt;&lt;1右儿子就是(rt&lt;&lt;1)+1）这么做比存一个结构体然后记录左右儿子的下标要节省空间……是看了notonlysuccess的线段树完整版之后才知道能这么办的，膜拜一下大神 […]</p>
         </div>

         <a id="comment-reply-5334"></a>
       </div>

       <div class="controls">
                  <a class="comment-reply-link" href="http://www.notonlysuccess.com/index.php/segment-tree-complete/?replytocom=5334#respond" onclick="return addComment.moveForm(&quot;comment-content-5334&quot;, &quot;5334&quot;, &quot;respond&quot;, &quot;978&quot;)">Reply <span>↓</span></a>       </div>

    </div>

  </div>
</li><!-- #comment-## -->

<!-- comment entry -->
<li>
  <div id="comment-5333" class="pingback even thread-even depth-1 clear-block with-avatars reader name-poj-3225-help-with-intervals-%e7%ba%bf%e6%ae%b5%e6%a0%91-%e9%9b%86%e5%90%88%e7%9a%84%e4%ba%a4%e5%b9%b6%e5%b7%ae%e8%a1%a5%e8%bf%90%e7%ae%97-%e7%8b%ac%e4%b9%90">

        <div class="avatar">
          </div>
    
    <div class="comment-head">
      <div class="ext clear-block">
        <span class="a"><a href="http://www.energycen.com/2012/07/25/poj-3225-help-with-intervals-%e7%ba%bf%e6%ae%b5%e6%a0%91-%e9%9b%86%e5%90%88%e7%9a%84%e4%ba%a4%e5%b9%b6%e5%b7%ae%e8%a1%a5%e8%bf%90%e7%ae%97/" rel="external nofollow" class="url">poj 3225 Help with Intervals 线段树 集合的交并差补运算 | 独乐</a></span> <span class="d">(6月)</span>       </div>
    </div>

    <div class="comment-body" id="comment-body-5333">
       <div class="comment-content clear-block" id="comment-content-5333">

         
         <div class="comment-text">
           <p>[…] 首先，如何简单处理开区间和闭区间的问题？我是看了notonlysuccess大神的方法才知道的 […]</p>
         </div>

         <a id="comment-reply-5333"></a>
       </div>

       <div class="controls">
                  <a class="comment-reply-link" href="http://www.notonlysuccess.com/index.php/segment-tree-complete/?replytocom=5333#respond" onclick="return addComment.moveForm(&quot;comment-content-5333&quot;, &quot;5333&quot;, &quot;respond&quot;, &quot;978&quot;)">Reply <span>↓</span></a>       </div>

    </div>

  </div>
</li><!-- #comment-## -->

<!-- comment entry -->
<li>
  <div id="comment-5331" class="pingback odd alt thread-odd thread-alt depth-1 clear-block with-avatars reader name-%e7%ba%bf%e6%ae%b5%e6%a0%91%e5%b0%8f%e7%bb%93-plumrain">

        <div class="avatar">
          </div>
    
    <div class="comment-head">
      <div class="ext clear-block">
        <span class="a"><a href="http://plumrain.org/segment-tree/" rel="external nofollow" class="url">线段树小结 | Plumrain</a></span> <span class="d">(6月)</span>       </div>
    </div>

    <div class="comment-body" id="comment-body-5331">
       <div class="comment-content clear-block" id="comment-content-5331">

         
         <div class="comment-text">
           <p>[…] 3、HDU 3642 Get The Treasury：比较复杂的题，看了题感觉是枚举+矩形面积交。。。然后就没写了。。。具体看NotOnlySuccess的题解吧。点击打开链接。 […]</p>
         </div>

         <a id="comment-reply-5331"></a>
       </div>

       <div class="controls">
                  <a class="comment-reply-link" href="http://www.notonlysuccess.com/index.php/segment-tree-complete/?replytocom=5331#respond" onclick="return addComment.moveForm(&quot;comment-content-5331&quot;, &quot;5331&quot;, &quot;respond&quot;, &quot;978&quot;)">Reply <span>↓</span></a>       </div>

    </div>

  </div>
</li><!-- #comment-## -->

<!-- comment entry -->
<li>
  <div id="comment-5330" class="pingback even thread-even depth-1 clear-block with-avatars reader name-hdu-1828-%e9%a2%98%e8%a7%a3-plumrain">

        <div class="avatar">
          </div>
    
    <div class="comment-head">
      <div class="ext clear-block">
        <span class="a"><a href="http://plumrain.org/hdu-1828/" rel="external nofollow" class="url">hdu 1828 题解 | Plumrain</a></span> <span class="d">(6月)</span>       </div>
    </div>

    <div class="comment-body" id="comment-body-5330">
       <div class="comment-content clear-block" id="comment-content-5330">

         
         <div class="comment-text">
           <p>[…] 解法：嗯。。。这题我是完全根据胡浩的博客NotOnlySuccess上面的线段树专题学习的。。。偷个懒，下面直接给出他的专题链接。。。。点击此处查看。 […]</p>
         </div>

         <a id="comment-reply-5330"></a>
       </div>

       <div class="controls">
                  <a class="comment-reply-link" href="http://www.notonlysuccess.com/index.php/segment-tree-complete/?replytocom=5330#respond" onclick="return addComment.moveForm(&quot;comment-content-5330&quot;, &quot;5330&quot;, &quot;respond&quot;, &quot;978&quot;)">Reply <span>↓</span></a>       </div>

    </div>

  </div>
</li><!-- #comment-## -->

<!-- comment entry -->
<li>
  <div id="comment-5329" class="pingback odd alt thread-odd thread-alt depth-1 clear-block with-avatars reader name-hdu-1542-%e9%a2%98%e8%a7%a3-plumrain">

        <div class="avatar">
          </div>
    
    <div class="comment-head">
      <div class="ext clear-block">
        <span class="a"><a href="http://plumrain.org/hdu-1542-atlantis/" rel="external nofollow" class="url">hdu 1542 题解 | Plumrain</a></span> <span class="d">(6月)</span>       </div>
    </div>

    <div class="comment-body" id="comment-body-5329">
       <div class="comment-content clear-block" id="comment-content-5329">

         
         <div class="comment-text">
           <p>[…] 解法：扫描线+线段树。我是完全按照胡浩大牛的博客NotOnlySuccess上面写的题解学得。。偷个懒不写题解了，这里给个他的题解链接。。。点击此处查看。 […]</p>
         </div>

         <a id="comment-reply-5329"></a>
       </div>

       <div class="controls">
                  <a class="comment-reply-link" href="http://www.notonlysuccess.com/index.php/segment-tree-complete/?replytocom=5329#respond" onclick="return addComment.moveForm(&quot;comment-content-5329&quot;, &quot;5329&quot;, &quot;respond&quot;, &quot;978&quot;)">Reply <span>↓</span></a>       </div>

    </div>

  </div>
</li><!-- #comment-## -->

<!-- comment entry -->
<li>
  <div id="comment-5316" class="comment even thread-even depth-1 clear-block with-avatars reader name-%e5%8c%bf%e5%90%8d">

        <div class="avatar">
      <img alt="" src="./NotOnlySuccess   【完全版】线段树_files/saved_resource" class="avatar avatar-48 photo avatar-default" height="48" width="48">    </div>
    
    <div class="comment-head">
      <div class="ext clear-block">
        <span class="a">匿名</span> <span class="d">(9月)</span>       </div>
    </div>

    <div class="comment-body" id="comment-body-5316">
       <div class="comment-content clear-block" id="comment-content-5316">

         
         <div class="comment-text">
           <p>hh大神 就是 如果按照您的这种线段树 能不能拿看下 hdu1119怎么做啊</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,5316,1,&#39;&#39;);">回复</a>]</p>         </div>

         <a id="comment-reply-5316"></a>
       </div>

       <div class="controls">
                  <a class="comment-reply-link" href="http://www.notonlysuccess.com/index.php/segment-tree-complete/?replytocom=5316#respond" onclick="return addComment.moveForm(&quot;comment-content-5316&quot;, &quot;5316&quot;, &quot;respond&quot;, &quot;978&quot;)">Reply <span>↓</span></a>       </div>

    </div>

  </div>
</li><!-- #comment-## -->

<!-- comment entry -->
<li>
  <div id="comment-5303" class="comment odd alt thread-odd thread-alt depth-1 clear-block with-avatars reader name-panamera">

        <div class="avatar">
      <img alt="" src="./NotOnlySuccess   【完全版】线段树_files/91af407864e954a1cd285953a40f3b40" class="avatar avatar-48 photo" height="48" width="48">    </div>
    
    <div class="comment-head">
      <div class="ext clear-block">
        <span class="a"><a href="http://www.qq.com/" rel="external nofollow" class="url">Panamera</a></span> <span class="d">(9月)</span>       </div>
    </div>

    <div class="comment-body" id="comment-body-5303">
       <div class="comment-content clear-block" id="comment-content-5303">

         
         <div class="comment-text">
           <p>想问下大神，为什么线段树的查询都是从1到n，从0到n-1不可以吗？？</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,5303,1,&#39;Panamera&#39;);">回复</a>]</p>         </div>

         <a id="comment-reply-5303"></a>
       </div>

       <div class="controls">
                  <a class="comment-reply-link" href="http://www.notonlysuccess.com/index.php/segment-tree-complete/?replytocom=5303#respond" onclick="return addComment.moveForm(&quot;comment-content-5303&quot;, &quot;5303&quot;, &quot;respond&quot;, &quot;978&quot;)">Reply <span>↓</span></a>       </div>

    </div>

  </div>
</li><!-- #comment-## -->

<!-- comment entry -->
<li>
  <div id="comment-5302" class="comment even thread-even depth-1 clear-block with-avatars reader name-panamera">

        <div class="avatar">
      <img alt="" src="./NotOnlySuccess   【完全版】线段树_files/91af407864e954a1cd285953a40f3b40" class="avatar avatar-48 photo" height="48" width="48">    </div>
    
    <div class="comment-head">
      <div class="ext clear-block">
        <span class="a">Panamera</span> <span class="d">(9月)</span>       </div>
    </div>

    <div class="comment-body" id="comment-body-5302">
       <div class="comment-content clear-block" id="comment-content-5302">

         
         <div class="comment-text">
           <p>想问下，大神，为什么线段树的查询是从1到n，从0到n-1不可以吗？</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,5302,1,&#39;Panamera&#39;);">回复</a>]</p>         </div>

         <a id="comment-reply-5302"></a>
       </div>

       <div class="controls">
                  <a class="comment-reply-link" href="http://www.notonlysuccess.com/index.php/segment-tree-complete/?replytocom=5302#respond" onclick="return addComment.moveForm(&quot;comment-content-5302&quot;, &quot;5302&quot;, &quot;respond&quot;, &quot;978&quot;)">Reply <span>↓</span></a>       </div>

    </div>

  </div>
</li><!-- #comment-## -->

<!-- comment entry -->
<li>
  <div id="comment-5250" class="pingback odd alt thread-odd thread-alt depth-1 clear-block with-avatars reader name-hdu-3397-sequence-operation-%e7%bc%96%e7%a8%8b%e8%af%ad%e8%a8%80-%e5%bc%80%e5%8f%91%e8%80%85%e7%ac%ac2315456%e4%b8%aa%e9%97%ae%e7%ad%94">

        <div class="avatar">
          </div>
    
    <div class="comment-head">
      <div class="ext clear-block">
        <span class="a"><a href="http://www.w3c.com.cn/hdu-3397-sequence-operation" rel="external nofollow" class="url">hdu 3397 Sequence operation - 编程语言 - 开发者第2315456个问答</a></span> <span class="d">(11月)</span>       </div>
    </div>

    <div class="comment-body" id="comment-body-5250">
       <div class="comment-content clear-block" id="comment-content-5250">

         
         <div class="comment-text">
           <p>[…] &nbsp; 所以我们就要记录 &nbsp;最长1的 &nbsp; 这一点我给个傻仔的链接。里面所说的POJ 3667 &nbsp;HOTEL 很像 &nbsp; […]</p>
         </div>

         <a id="comment-reply-5250"></a>
       </div>

       <div class="controls">
                  <a class="comment-reply-link" href="http://www.notonlysuccess.com/index.php/segment-tree-complete/?replytocom=5250#respond" onclick="return addComment.moveForm(&quot;comment-content-5250&quot;, &quot;5250&quot;, &quot;respond&quot;, &quot;978&quot;)">Reply <span>↓</span></a>       </div>

    </div>

  </div>
</li><!-- #comment-## -->

<!-- comment entry -->
<li>
  <div id="comment-4969" class="comment even thread-even depth-1 clear-block with-avatars reader name-nolan">

        <div class="avatar">
      <img alt="" src="./NotOnlySuccess   【完全版】线段树_files/6fd02e68bfa71a2f48be7e36639cd1ba" class="avatar avatar-48 photo" height="48" width="48">    </div>
    
    <div class="comment-head">
      <div class="ext clear-block">
        <span class="a"><a href="http://www.163.com/" rel="external nofollow" class="url">nolan</a></span> <span class="d">(1年)</span>       </div>
    </div>

    <div class="comment-body" id="comment-body-4969">
       <div class="comment-content clear-block" id="comment-content-4969">

         
         <div class="comment-text">
           <p>poj3667中的变量都什么意思？<br>
lsum, rsum ,msum?<br>
看了一个下午。。。。。。都不懂，求解释啊，谢谢。</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,4969,1,&#39;nolan&#39;);">回复</a>]</p><div class="comment-childs chalt" id="comment-4978"><img alt="" src="./NotOnlySuccess   【完全版】线段树_files/3ddd0d326d736066c8b005167a2390b7" class="avatar avatar-32 photo" height="32" width="32"><p><cite>abbranter</cite> 回复:<br><small class="commentmetadata">八月 16th, 2013 at 15:41</small></p><p>lsum：左子树区间和；rsum：右子树的区间和；msum：节点区间的最大和；</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,4978,2,&#39;abbranter&#39;);">回复</a>]</p></div>         </div>

         <a id="comment-reply-4969"></a>
       </div>

       <div class="controls">
                  <a class="comment-reply-link" href="http://www.notonlysuccess.com/index.php/segment-tree-complete/?replytocom=4969#respond" onclick="return addComment.moveForm(&quot;comment-content-4969&quot;, &quot;4969&quot;, &quot;respond&quot;, &quot;978&quot;)">Reply <span>↓</span></a>       </div>

    </div>

  </div>
</li><!-- #comment-## -->

<!-- comment entry -->
<li>
  <div id="comment-4938" class="comment odd alt thread-odd thread-alt depth-1 clear-block with-avatars reader name-abbranter">

        <div class="avatar">
      <img alt="" src="./NotOnlySuccess   【完全版】线段树_files/3ddd0d326d736066c8b005167a2390b7(1)" class="avatar avatar-48 photo" height="48" width="48">    </div>
    
    <div class="comment-head">
      <div class="ext clear-block">
        <span class="a">abbranter</span> <span class="d">(1年)</span>       </div>
    </div>

    <div class="comment-body" id="comment-body-4938">
       <div class="comment-content clear-block" id="comment-content-4938">

         
         <div class="comment-text">
           <p>poj2528，对于query中的if条件，如果父节点满足条件，应该是不会再查询子节点，可是如果先后输入1-10 2-6 3-8，会算出1张海报，那就错了呀，应该是三张才对？</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,4938,1,&#39;abbranter&#39;);">回复</a>]</p><div class="comment-childs chalt" id="comment-4944"><img alt="" src="./NotOnlySuccess   【完全版】线段树_files/d56a7b2bed9a50c2e21900fb0a32d937" class="avatar avatar-32 photo" height="32" width="32"><p><cite>shǎ崽</cite> 回复:<br><small class="commentmetadata">八月 12th, 2013 at 14:01</small></p><p>不明白你的意思<br>
你说的这点"如果父节点满足条件，应该是不会再查询子节点"是正确的.<br>
但是你给的这个例子,2-6和3-8是会改变其父节点1-10的状态的</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,4944,2,&#39;shǎ崽&#39;);">回复</a>]</p><div class="comment-childs" id="comment-4951"><img alt="" src="./NotOnlySuccess   【完全版】线段树_files/3ddd0d326d736066c8b005167a2390b7" class="avatar avatar-32 photo" height="32" width="32"><p><cite>abbranter</cite> 回复:<br><small class="commentmetadata">八月 13th, 2013 at 13:37</small></p><p>那1-10是怎么回复它的状态的？</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,4951,3,&#39;abbranter&#39;);">回复</a>]</p></div></div>         </div>

         <a id="comment-reply-4938"></a>
       </div>

       <div class="controls">
                  <a class="comment-reply-link" href="http://www.notonlysuccess.com/index.php/segment-tree-complete/?replytocom=4938#respond" onclick="return addComment.moveForm(&quot;comment-content-4938&quot;, &quot;4938&quot;, &quot;respond&quot;, &quot;978&quot;)">Reply <span>↓</span></a>       </div>

    </div>

  </div>
</li><!-- #comment-## -->

<!-- comment entry -->
<li>
  <div id="comment-4891" class="comment even thread-even depth-1 clear-block with-avatars reader name-notonlysuccess">

        <div class="avatar">
      <img alt="" src="./NotOnlySuccess   【完全版】线段树_files/3ddd0d326d736066c8b005167a2390b7(1)" class="avatar avatar-48 photo" height="48" width="48">    </div>
    
    <div class="comment-head">
      <div class="ext clear-block">
        <span class="a">@NotOnlySuccess</span> <span class="d">(1年)</span>       </div>
    </div>

    <div class="comment-body" id="comment-body-4891">
       <div class="comment-content clear-block" id="comment-content-4891">

         
         <div class="comment-text">
           <p>hdu1698中的pushdown操作，为什么（m-(m&gt;&gt;1））与m&gt;&gt;1互换会得到错误答案而只将m&gt;&gt;1改成（m-(m&gt;&gt;1))却不会错，两个不是一样的吗？？？</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,4891,1,&#39;@NotOnlySuccess&#39;);">回复</a>]</p><div class="comment-childs chalt" id="comment-4892"><img alt="" src="./NotOnlySuccess   【完全版】线段树_files/19a922061a184c5a75cc2d6124248c3b" class="avatar avatar-32 photo" height="32" width="32"><p><cite>LeoHLF</cite> 回复:<br><small class="commentmetadata">八月 9th, 2013 at 13:04</small></p><p>（m-(m&gt;&gt;1) &gt;1)<br>
当m是奇数时小于，偶数时等于</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,4892,2,&#39;LeoHLF&#39;);">回复</a>]</p></div><div class="comment-childs chalt" id="comment-4899"><img alt="" src="./NotOnlySuccess   【完全版】线段树_files/d56a7b2bed9a50c2e21900fb0a32d937" class="avatar avatar-32 photo" height="32" width="32"><p><cite>shǎ崽</cite> 回复:<br><small class="commentmetadata">八月 9th, 2013 at 14:59</small></p><p>这一段写的不太好,太晦涩了,你就理解成一个左子树的长度,一个是右子树的长度吧.按自己喜欢的写法来</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,4899,2,&#39;shǎ崽&#39;);">回复</a>]</p></div>         </div>

         <a id="comment-reply-4891"></a>
       </div>

       <div class="controls">
                  <a class="comment-reply-link" href="http://www.notonlysuccess.com/index.php/segment-tree-complete/?replytocom=4891#respond" onclick="return addComment.moveForm(&quot;comment-content-4891&quot;, &quot;4891&quot;, &quot;respond&quot;, &quot;978&quot;)">Reply <span>↓</span></a>       </div>

    </div>

  </div>
</li><!-- #comment-## -->

<!-- comment entry -->
<li>
  <div id="comment-4890" class="comment odd alt thread-odd thread-alt depth-1 clear-block with-avatars reader name-leohlf">

        <div class="avatar">
      <img alt="" src="./NotOnlySuccess   【完全版】线段树_files/19a922061a184c5a75cc2d6124248c3b(1)" class="avatar avatar-48 photo" height="48" width="48">    </div>
    
    <div class="comment-head">
      <div class="ext clear-block">
        <span class="a">LeoHLF</span> <span class="d">(1年)</span>       </div>
    </div>

    <div class="comment-body" id="comment-body-4890">
       <div class="comment-content clear-block" id="comment-content-4890">

         
         <div class="comment-text">
           <p>HH大神，2528我觉得只要把每个单位长度看两个点。<br>
长度为N个单位长度的Billboard看成从点0到点N的N+1个点再用一般的离散化方法是不是会简单点。您觉得可以吗？</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,4890,1,&#39;LeoHLF&#39;);">回复</a>]</p><div class="comment-childs chalt" id="comment-4897"><img alt="" src="./NotOnlySuccess   【完全版】线段树_files/d56a7b2bed9a50c2e21900fb0a32d937" class="avatar avatar-32 photo" height="32" width="32"><p><cite>shǎ崽</cite> 回复:<br><small class="commentmetadata">八月 9th, 2013 at 14:58</small></p><p>可以试试看,我觉得行,等你好消息.</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,4897,2,&#39;shǎ崽&#39;);">回复</a>]</p></div>         </div>

         <a id="comment-reply-4890"></a>
       </div>

       <div class="controls">
                  <a class="comment-reply-link" href="http://www.notonlysuccess.com/index.php/segment-tree-complete/?replytocom=4890#respond" onclick="return addComment.moveForm(&quot;comment-content-4890&quot;, &quot;4890&quot;, &quot;respond&quot;, &quot;978&quot;)">Reply <span>↓</span></a>       </div>

    </div>

  </div>
</li><!-- #comment-## -->

<!-- comment entry -->
<li>
  <div id="comment-4832" class="comment even thread-even depth-1 clear-block with-avatars reader name-darkdream">

        <div class="avatar">
      <img alt="" src="./NotOnlySuccess   【完全版】线段树_files/6db411f95ca975fd921c1441dfb3464e" class="avatar avatar-48 photo" height="48" width="48">    </div>
    
    <div class="comment-head">
      <div class="ext clear-block">
        <span class="a">darkdream</span> <span class="d">(1年)</span>       </div>
    </div>

    <div class="comment-body" id="comment-body-4832">
       <div class="comment-content clear-block" id="comment-content-4832">

         
         <div class="comment-text">
           <p>HH大牛，你的poj2528的代码好像过不了，，目测maxn开小了。。</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,4832,1,&#39;darkdream&#39;);">回复</a>]</p>         </div>

         <a id="comment-reply-4832"></a>
       </div>

       <div class="controls">
                  <a class="comment-reply-link" href="http://www.notonlysuccess.com/index.php/segment-tree-complete/?replytocom=4832#respond" onclick="return addComment.moveForm(&quot;comment-content-4832&quot;, &quot;4832&quot;, &quot;respond&quot;, &quot;978&quot;)">Reply <span>↓</span></a>       </div>

    </div>

  </div>
</li><!-- #comment-## -->

<!-- comment entry -->
<li>
  <div id="comment-4790" class="comment odd alt thread-odd thread-alt depth-1 clear-block with-avatars reader name-hnust_xuran">

        <div class="avatar">
      <img alt="" src="./NotOnlySuccess   【完全版】线段树_files/saved_resource" class="avatar avatar-48 photo avatar-default" height="48" width="48">    </div>
    
    <div class="comment-head">
      <div class="ext clear-block">
        <span class="a">hnust_xuran</span> <span class="d">(1年)</span>       </div>
    </div>

    <div class="comment-body" id="comment-body-4790">
       <div class="comment-content clear-block" id="comment-content-4790">

         
         <div class="comment-text">
           <p>想问一个下PKU2528的那个hash数组，是有什么特殊用途么？</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,4790,1,&#39;hnust_xuran&#39;);">回复</a>]</p>         </div>

         <a id="comment-reply-4790"></a>
       </div>

       <div class="controls">
                  <a class="comment-reply-link" href="http://www.notonlysuccess.com/index.php/segment-tree-complete/?replytocom=4790#respond" onclick="return addComment.moveForm(&quot;comment-content-4790&quot;, &quot;4790&quot;, &quot;respond&quot;, &quot;978&quot;)">Reply <span>↓</span></a>       </div>

    </div>

  </div>
</li><!-- #comment-## -->

<!-- comment entry -->
<li>
  <div id="comment-4762" class="comment even thread-even depth-1 clear-block with-avatars reader name-iris_hit">

        <div class="avatar">
      <img alt="" src="./NotOnlySuccess   【完全版】线段树_files/266ecd3255374ab75cc4b7fb4021674a" class="avatar avatar-48 photo" height="48" width="48">    </div>
    
    <div class="comment-head">
      <div class="ext clear-block">
        <span class="a">Iris_HIT</span> <span class="d">(1年)</span>       </div>
    </div>

    <div class="comment-body" id="comment-body-4762">
       <div class="comment-content clear-block" id="comment-content-4762">

         
         <div class="comment-text">
           <p>poj 2528题<br>
更新的时候应该是update(l , r , i , 0 , m - 1 , 1);吧?右端点最大为m-1啊<br>
query也是query(0 , m - 1 , 1);</p>
<p>是这样么?AC都是可以的..</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,4762,1,&#39;Iris_HIT&#39;);">回复</a>]</p><div class="comment-childs chalt" id="comment-4766"><img alt="" src="./NotOnlySuccess   【完全版】线段树_files/266ecd3255374ab75cc4b7fb4021674a(1)" class="avatar avatar-32 photo" height="32" width="32"><p><cite>Iris_HIT</cite> 回复:<br><small class="commentmetadata">七月 31st, 2013 at 13:33</small></p><p>还有 poj3225Help with Intervals中query函数中的if (l == r) return;也是不需要的吧?叶子节点的col为-1这个情况应该是不会出现...</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,4766,2,&#39;Iris_HIT&#39;);">回复</a>]</p><div class="comment-childs" id="comment-4769"><img alt="" src="./NotOnlySuccess   【完全版】线段树_files/d56a7b2bed9a50c2e21900fb0a32d937" class="avatar avatar-32 photo" height="32" width="32"><p><cite>shǎ崽</cite> 回复:<br><small class="commentmetadata">七月 31st, 2013 at 15:31</small></p><p>You are right,已经修改了,加了一行注释<br>
感谢提出意见:)</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,4769,3,&#39;shǎ崽&#39;);">回复</a>]</p></div></div><div class="comment-childs chalt" id="comment-4768"><img alt="" src="./NotOnlySuccess   【完全版】线段树_files/d56a7b2bed9a50c2e21900fb0a32d937" class="avatar avatar-32 photo" height="32" width="32"><p><cite>shǎ崽</cite> 回复:<br><small class="commentmetadata">七月 31st, 2013 at 15:30</small></p><p>对的,m-1确实最最小边界.至于为什么m也能AC这个问题,只需要比m-1大,你试试m+1,或者m+100,只要数组足够大,都是合法的,只是后边的空间会浪费而已</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,4768,2,&#39;shǎ崽&#39;);">回复</a>]</p></div>         </div>

         <a id="comment-reply-4762"></a>
       </div>

       <div class="controls">
                  <a class="comment-reply-link" href="http://www.notonlysuccess.com/index.php/segment-tree-complete/?replytocom=4762#respond" onclick="return addComment.moveForm(&quot;comment-content-4762&quot;, &quot;4762&quot;, &quot;respond&quot;, &quot;978&quot;)">Reply <span>↓</span></a>       </div>

    </div>

  </div>
</li><!-- #comment-## -->

<!-- comment entry -->
<li>
  <div id="comment-4409" class="comment odd alt thread-odd thread-alt depth-1 clear-block with-avatars reader name-lisz">

        <div class="avatar">
      <img alt="" src="./NotOnlySuccess   【完全版】线段树_files/6bfc477f3669fcc49e15977f82123b60" class="avatar avatar-48 photo" height="48" width="48">    </div>
    
    <div class="comment-head">
      <div class="ext clear-block">
        <span class="a">Lisz</span> <span class="d">(1年)</span>       </div>
    </div>

    <div class="comment-body" id="comment-body-4409">
       <div class="comment-content clear-block" id="comment-content-4409">

         
         <div class="comment-text">
           <p>HH牛， 求教一下<br>
Atlantis  求矩形并的这题扫描线里面 cnt 域更新的时候为什么不需要用 懒惰标记<br>
cnt 更新的时候应该是成段更新吧 。没有 pushdown 不会出问题吗</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,4409,1,&#39;Lisz&#39;);">回复</a>]</p><div class="comment-childs chalt" id="comment-4420"><img alt="" src="./NotOnlySuccess   【完全版】线段树_files/6bfc477f3669fcc49e15977f82123b60(1)" class="avatar avatar-32 photo" height="32" width="32"><p><cite>Lisz</cite> 回复:<br><small class="commentmetadata">七月 17th, 2013 at 10:12</small></p><p>我懂了</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,4420,2,&#39;Lisz&#39;);">回复</a>]</p></div>         </div>

         <a id="comment-reply-4409"></a>
       </div>

       <div class="controls">
                  <a class="comment-reply-link" href="http://www.notonlysuccess.com/index.php/segment-tree-complete/?replytocom=4409#respond" onclick="return addComment.moveForm(&quot;comment-content-4409&quot;, &quot;4409&quot;, &quot;respond&quot;, &quot;978&quot;)">Reply <span>↓</span></a>       </div>

    </div>

  </div>
</li><!-- #comment-## -->

<!-- comment entry -->
<li>
  <div id="comment-4251" class="comment even thread-even depth-1 clear-block with-avatars reader name-bman">

        <div class="avatar">
      <img alt="" src="./NotOnlySuccess   【完全版】线段树_files/88dcf250e3acfe191e046d27f2dea881" class="avatar avatar-48 photo" height="48" width="48">    </div>
    
    <div class="comment-head">
      <div class="ext clear-block">
        <span class="a">BMan</span> <span class="d">(1年)</span>       </div>
    </div>

    <div class="comment-body" id="comment-body-4251">
       <div class="comment-content clear-block" id="comment-content-4251">

         
         <div class="comment-text">
           <p>POJ 2528:X数组应该开4*n才对吧。当这样的时候：<br>
10000<br>
1 3<br>
5 7<br>
9 11 ....<br>
by the way,HH大牛的博客太赞了，接下来很长一段时间都打算在这里常驻学习了.</p>
<p class="thdrpy">[<a href="javascript:void(0)" onclick="movecfm(event,4251,1,&#39;BMan&#39;);">回复</a>]</p>         </div>

         <a id="comment-reply-4251"></a>
       </div>

       <div class="controls">
                  <a class="comment-reply-link" href="http://www.notonlysuccess.com/index.php/segment-tree-complete/?replytocom=4251#respond" onclick="return addComment.moveForm(&quot;comment-content-4251&quot;, &quot;4251&quot;, &quot;respond&quot;, &quot;978&quot;)">Reply <span>↓</span></a>       </div>

    </div>

  </div>
</li><!-- #comment-## -->
</ul>

<div class="page-navi clear-block">
  <div class="alignleft"><a href="http://www.notonlysuccess.com/index.php/segment-tree-complete/comment-page-2/#comments">« Older Comments</a></div>
  <div class="alignright"></div>
</div>


								<div id="respond" class="comment-respond">
				<h3 id="reply-title" class="comment-reply-title">发表评论 <small><a rel="nofollow" id="cancel-comment-reply-link" href="http://www.notonlysuccess.com/index.php/segment-tree-complete/#respond" style="display:none;">取消回复</a></small></h3>
									<form action="http://www.notonlysuccess.com/success/wp-comments-post.php" method="post" id="commentform" class="comment-form">
																			<p class="comment-notes">电子邮件地址不会被公开。</p>							<p class="comment-form-author"><label for="author">姓名</label> <input id="author" name="author" type="text" value="" size="30"></p>
<p class="comment-form-email"><label for="email">电子邮件</label> <input id="email" name="email" type="text" value="" size="30"></p>
<p class="comment-form-url"><label for="url">站点</label> <input id="url" name="url" type="text" value="" size="30"></p>
												<p class="comment-form-comment"><label for="comment">评论</label> <textarea id="comment" name="comment" cols="45" rows="8" aria-required="true"></textarea></p>						<p class="form-allowed-tags">您可以使用这些<abbr title="HyperText Markup Language">HTML</abbr>标签和属性： <code>&lt;a href="" title=""&gt; &lt;abbr title=""&gt; &lt;acronym title=""&gt; &lt;b&gt; &lt;blockquote cite=""&gt; &lt;cite&gt; &lt;code&gt; &lt;del datetime=""&gt; &lt;em&gt; &lt;i&gt; &lt;q cite=""&gt; &lt;strike&gt; &lt;strong&gt; </code></p>						<p class="form-submit">
							<input name="submit" type="submit" id="submit" value="发表评论">
							<input type="hidden" name="comment_post_ID" value="978" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
						</p>
						<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="d3d18c6138"></p><input type="hidden" name="cl_post_title" id="cl_post_title" value=""><input type="hidden" name="cl_post_url" id="cl_post_url" value=""><input type="hidden" name="cl_prem" id="cl_prem" value=""><div id="commentluv"><div id="cl_messages"></div><input type="checkbox" id="doluv" name="doluv" checked="checked"><span id="mylastpost"><img alt="CommentLuv badge" src="./NotOnlySuccess   【完全版】线段树_files/CL91_default.png"></span><span id="showmorespan"><img class="clarrow" id="showmore" src="./NotOnlySuccess   【完全版】线段树_files/down-arrow.gif" alt="显示更多文章" title="显示更多文章" style="display:none;"></span></div><div id="lastposts" style="display:none;"></div><b>注意</b>: 评论者允许使用<b>'@user空格'</b>的方式将自己的评论通知另外评论者。例如， ABC是本文的评论者之一，则使用'@ABC '(不包括单引号)将会自动将您的评论发送给ABC。使用'@all '，将会将评论发送给之前所有其它评论者。请务必注意user必须和评论者名相匹配(大小写一致)。<p><input type="hidden" id="comment_reply_ID" name="comment_reply_ID" value="0"><input type="hidden" id="comment_reply_dp" name="comment_reply_dp" value="0"></p><div id="cancel_reply" style="display:none;"><a href="javascript:void(0)" onclick="movecfm(null,0,1,null);" style="color:red;">点击取消回复</a></div><p><input type="checkbox" name="comment_mail_notify" id="comment_mail_notify" value="comment_mail_notify" checked="checked" style="width: auto;"><label for="comment_mail_notify" style="display: inline;">有人回复时邮件通知我</label></p><script type="text/javascript">
/* <![CDATA[ */
var commentformid = "";
var USERINFO = false;
var atreply = "none";
/* ]]> */
</script>
<script type="text/javascript" src="./NotOnlySuccess   【完全版】线段树_files/wp-thread-comment.js.php"></script>
					</form>
							</div><!-- #respond -->
						
          

        </div>
        <!-- /primary content -->

        
  <!-- 1st sidebar -->
  <div id="sidebar">

    <ul class="blocks">

      <li class="block"><div class="block-content block-widget_search clear-block" id="instance-search-5">
<!-- search form -->
<div class="search-form">
  <form method="get" class="search-form clear-block" name="search-form" id="search-form" action="http://www.notonlysuccess.com/">
    <a href="http://www.notonlysuccess.com/index.php/segment-tree-complete/#" class="submit" onclick="document.getElementById(&#39;search-form&#39;).submit();">Search Website</a>
    <fieldset>
      <input type="text" name="s" alt="Search Website" class="text alignleft" value="" placeholder="Search">
      <input type="hidden" value="submit">
    </fieldset>
  </form>
</div>
<!-- /search form --></div></li>		<li class="block"><div class="block-content block-widget_recent_entries clear-block" id="instance-recent-posts-6">		<div class="title"><h3>近期文章</h3><div class="bl"></div><div class="br"></div></div>		<ul>
					<li>
				<a href="http://www.notonlysuccess.com/index.php/a_hard_problem/" title="一道难题">一道难题</a>
						</li>
					<li>
				<a href="http://www.notonlysuccess.com/index.php/story-4/" title="江湖故事(四)">江湖故事(四)</a>
						</li>
					<li>
				<a href="http://www.notonlysuccess.com/index.php/marathon/" title="当我跑步的时候,我在想些什么">当我跑步的时候,我在想些什么</a>
						</li>
					<li>
				<a href="http://www.notonlysuccess.com/index.php/real/" title="REAL">REAL</a>
						</li>
					<li>
				<a href="http://www.notonlysuccess.com/index.php/story-3/" title="江湖故事(三)">江湖故事(三)</a>
						</li>
				</ul>
		</div></li><li class="block"><div class="block-content block-widget_recent_comments clear-block" id="instance-recent-comments-2"><div class="title"><h3>近期评论</h3><div class="bl"></div><div class="br"></div></div><ul id="recentcomments"><li class="recentcomments"><a href="http://catcamera.net/agoura-hills-massage-school-a2z-health-best-massage-therapy-schools/" rel="external nofollow" class="url">A2Z Health Massage School</a>发表在《<a href="http://www.notonlysuccess.com/index.php/algorithm-of-network/comment-page-1/#comment-5422">网络流的几个常见算法</a>》</li><li class="recentcomments"><a href="http://lula.pl/blogi/spodnie-damskie" rel="external nofollow" class="url">spodnie dla kobiet</a>发表在《<a href="http://www.notonlysuccess.com/index.php/algorithm-of-network/comment-page-1/#comment-5421">网络流的几个常见算法</a>》</li><li class="recentcomments"><a href="https://www.youtube.com/watch?v=Vmg_x_wVr40" rel="external nofollow" class="url">Kansas City Emergency plumber</a>发表在《<a href="http://www.notonlysuccess.com/index.php/algorithm-of-network/comment-page-1/#comment-5420">网络流的几个常见算法</a>》</li><li class="recentcomments">匿名发表在《<a href="http://www.notonlysuccess.com/index.php/segment-tree-complete/comment-page-3/#comment-5417">【完全版】线段树</a>》</li><li class="recentcomments"><a href="http://auto.cr/" rel="external nofollow" class="url">Autos Usados En Venta</a>发表在《<a href="http://www.notonlysuccess.com/index.php/algorithm-of-network/comment-page-1/#comment-5415">网络流的几个常见算法</a>》</li></ul></div></li><li class="block"><div class="block-content block-widget_links clear-block" id="linkcat-105"><div class="title"><h3>Special</h3><div class="bl"></div><div class="br"></div></div>
	<ul class="xoxo blogroll">
<li><a href="http://innermist.hk/" title="婆娘">小泥巴MM</a></li>

	</ul>
</div></li>
<li class="block"><div class="block-content block-widget_links clear-block" id="linkcat-98"><div class="title"><h3>众犇</h3><div class="bl"></div><div class="br"></div></div>
	<ul class="xoxo blogroll">
<li><a href="http://hi.baidu.com/aekdycoin" title="数论神牛,景润后代.福州核武,一统江湖" target="_blank">AekdyCoin</a></li>
<li><a href="http://dumbear.com/blog/" title="亚熊的熊洞">Dumbear</a></li>
<li><a href="http://www.hhanger.com/blog" title="世界第六,宇宙第一" target="_blank">hhanger</a></li>
<li><a href="http://qinz.maybe.im/" title="比如说空字符串" target="_blank">Qinz</a></li>
<li><a href="http://www.starvae.com/" title="小菊花" target="_blank">starvae</a></li>
<li><a href="http://www.wutianqi.com/" title="Tanky Woo" target="_blank">Tanky Woo</a></li>
<li><a href="http://ganlu.name/blog/" title="散文小王子." target="_blank">teddy</a></li>
<li><a href="http://www.forgetwind.com/" title="WenceXie">WenceXie</a></li>
<li><a href="http://www.zlinkin.com/" title="庒碧立体" target="_blank">zlinkin</a></li>
<li><a href="http://davidzai.blog.163.com/" title="3鲜师傅,自创图灵树,各种数据结构" target="_blank">三鲜</a></li>
<li><a href="http://blog.y-mc.info/">严明超</a></li>
<li><a href="http://boskijr.com/" title="帅帅的波神">小波斯基</a></li>
<li><a href="http://caitengwei.com/blog/" title="什么都会的蔡腾伟,很Orz他" target="_blank">蔡大蛙</a></li>
<li><a href="http://blog.yes2.me/" title="各种会">钟超</a></li>
<li><a href="http://blog.oldsharp.info/" title="情歌王子">陈锐</a></li>

	</ul>
</div></li>
<li class="block"><div class="block-content block-widget_links clear-block" id="linkcat-2"><div class="title"><h3>其他</h3><div class="bl"></div><div class="br"></div></div>
	<ul class="xoxo blogroll">
<li><a href="http://s8.hk/ad/css3.html" title="让IE早点灭亡吧">css3测试</a></li>
<li><a href="http://nehe.gamedev.net/" title="见过最好的教学网站">Open GL</a></li>
<li><a href="http://www.lepu.com/" title="创意商店">乐铺</a></li>
<li><a href="http://www.woiweb.net/" title="收录各种炫酷效果的网站">我爱互联网</a></li>
<li><a href="http://www.flickr.com/photos/notonlysuccess/" target="_blank">我的flickr相册</a></li>
<li><a href="http://tieba.baidu.com/f?ct=&tn=&rn=&pn=&lm=&cm=0&kw=%BB%F0%B7%EF%C1%C7%D4%AD&rs2=0&sc=&un=&rs1=&rs5=&sn=&rs6=&myselectvalue=0&word=%BB%F0%B7%EF%C1%C7%D4%AD&submit=%B0%D9%B6%C8%D2%BB%CF%C2&am" title="贴吧.史上最强大漫画" target="_blank">火凤燎原</a></li>
<li><a href="http://blog.sina.com.cn/twocold" title="开车的,写字的" target="_blank">韩寒</a></li>

	</ul>
</div></li>
<li class="block"><div class="block-content block-widget_archive clear-block" id="instance-archives-3"><div class="title"><h3>文章归档</h3><div class="bl"></div><div class="br"></div></div>		<ul>
			<li><a href="http://www.notonlysuccess.com/index.php/2012/08/" title="2012年八月">2012年八月</a></li>
	<li><a href="http://www.notonlysuccess.com/index.php/2012/04/" title="2012年四月">2012年四月</a></li>
	<li><a href="http://www.notonlysuccess.com/index.php/2011/11/" title="2011年十一月">2011年十一月</a></li>
	<li><a href="http://www.notonlysuccess.com/index.php/2011/10/" title="2011年十月">2011年十月</a></li>
	<li><a href="http://www.notonlysuccess.com/index.php/2011/09/" title="2011年九月">2011年九月</a></li>
	<li><a href="http://www.notonlysuccess.com/index.php/2011/08/" title="2011年八月">2011年八月</a></li>
	<li><a href="http://www.notonlysuccess.com/index.php/2011/07/" title="2011年七月">2011年七月</a></li>
	<li><a href="http://www.notonlysuccess.com/index.php/2011/06/" title="2011年六月">2011年六月</a></li>
	<li><a href="http://www.notonlysuccess.com/index.php/2011/04/" title="2011年四月">2011年四月</a></li>
	<li><a href="http://www.notonlysuccess.com/index.php/2011/02/" title="2011年二月">2011年二月</a></li>
	<li><a href="http://www.notonlysuccess.com/index.php/2011/01/" title="2011年一月">2011年一月</a></li>
	<li><a href="http://www.notonlysuccess.com/index.php/2010/12/" title="2010年十二月">2010年十二月</a></li>
	<li><a href="http://www.notonlysuccess.com/index.php/2010/11/" title="2010年十一月">2010年十一月</a></li>
	<li><a href="http://www.notonlysuccess.com/index.php/2010/09/" title="2010年九月">2010年九月</a></li>
	<li><a href="http://www.notonlysuccess.com/index.php/2010/08/" title="2010年八月">2010年八月</a></li>
	<li><a href="http://www.notonlysuccess.com/index.php/2010/07/" title="2010年七月">2010年七月</a></li>
	<li><a href="http://www.notonlysuccess.com/index.php/2010/06/" title="2010年六月">2010年六月</a></li>
	<li><a href="http://www.notonlysuccess.com/index.php/2010/05/" title="2010年五月">2010年五月</a></li>
	<li><a href="http://www.notonlysuccess.com/index.php/2010/04/" title="2010年四月">2010年四月</a></li>
	<li><a href="http://www.notonlysuccess.com/index.php/2010/03/" title="2010年三月">2010年三月</a></li>
	<li><a href="http://www.notonlysuccess.com/index.php/2010/02/" title="2010年二月">2010年二月</a></li>
	<li><a href="http://www.notonlysuccess.com/index.php/2010/01/" title="2010年一月">2010年一月</a></li>
	<li><a href="http://www.notonlysuccess.com/index.php/2009/12/" title="2009年十二月">2009年十二月</a></li>
	<li><a href="http://www.notonlysuccess.com/index.php/2009/11/" title="2009年十一月">2009年十一月</a></li>
		</ul>
</div></li><li class="block"><div class="block-content block-widget_meta clear-block" id="instance-meta-4"><div class="title"><h3>功能</h3><div class="bl"></div><div class="br"></div></div>			<ul>
						<li><a href="http://www.notonlysuccess.com/success/wp-login.php">登录</a></li>
			<li><a href="http://www.notonlysuccess.com/index.php/feed/" title="使用RSS 2.0订阅本站点内容">文章<abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="http://www.notonlysuccess.com/index.php/comments/feed/" title="使用RSS订阅本站点的所有文章的近期评论">评论<abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="http://cn.wordpress.org/" title="基于WordPress，一个优美、先进的个人信息发布平台。">WordPress.org</a></li>						</ul>
</div></li>    </ul>

  </div>
  <!-- /1st sidebar -->

      </div>
    </div>
  </div>
  <!-- /main content -->


<script type="text/javascript">
(function() {
    var c = document.createElement('script'); 
    c.type = 'text/javascript';
    c.async = true;
    c.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'www.clicki.cn/boot/47793';
    var h = document.getElementsByTagName('script')[0];
    h.parentNode.insertBefore(c, h);
})();
</script>

   </div>
 </div>
 <!-- /main -->

 
 <!-- footer -->
 <div class="shadow-left page-content">
   <div class="shadow-right">

     <div id="footer">

       <div id="copyright">

         <a href="http://www.notonlysuccess.com/" title="NotOnlySuccess" rel="home"><strong>NotOnlySuccess</strong></a>

         © 2011 |

         Powered by <a href="http://wordpress.org/">WordPress</a> and Mystique theme by <a href="http://digitalnature.eu/themes/mystique/">digitalnature</a>
         <br>

         251 queries in 1.50 seconds
         (32.95M)                 

       </div>

     </div>

   </div>
 </div>
 <!-- /footer -->

 <a class="go-top" href="http://www.notonlysuccess.com/index.php/segment-tree-complete/#page">Go to Top</a>

 </div>
 <!-- /page-ext -->

 </div>
 <!-- page -->

 <!-- 251 queries in 1.50 seconds -->
 




<span id="heart_tip_big" style="display: none;position:absolute; z-index: 1001; background-color: white; color: null; width: 62px;"></span><div id="HUABAN_WIDGETS"><div class="HUABAN-f-button" style="display: none;">采集</div><style>#HUABAN_WIDGETS  {font-family: "helvetica neue",arial,sans-serif; color: #444; font-size: 14px;} #HUABAN_WIDGETS * {box-sizing: content-box;} #HUABAN_WIDGETS .HUABAN-main {position: fixed; left: 0; top: 0; width: 100%; height: 100%; background: #e5e5e5; background: rgba(229,229,229,.95); max-height: 100%; overflow: hidden; z-index: 9999999999999;} #HUABAN_WIDGETS a img {border: 0;} #HUABAN_WIDGETS .HUABAN-header {height: 50px; background: white; box-shadow: 0 0 4px rgba(0,0,0,.2); width: 100%; left: 0; top: 0; position: absolute;} #HUABAN_WIDGETS .HUABAN-header .HUABAN-inner {margin: 0 auto; position: relative;} #HUABAN_WIDGETS .HUABAN-header .HUABAN-close {width: 60px; height: 50px; border-left: 1px solid #ddd; position: absolute; right: 0; top: 0; background: url(//huaban.com/img/widgets/btn_close.png) 20px 14px no-repeat; cursor: pointer;} #HUABAN_WIDGETS .HUABAN-header .HUABAN-close:hover {background-position: 20px -26px;} #HUABAN_WIDGETS .HUABAN-header .HUABAN-close:active {background-position: 20px -66px;} #HUABAN_WIDGETS .HUABAN-header .HUABAN-logo {display: block; position: absolute; top: 12px;} #HUABAN_WIDGETS .HUABAN-waterfall-holder {position: relative; overflow-y: auto; height: 100%;} #HUABAN_WIDGETS .HUABAN-waterfall {position: relative; margin-top: 50px;} #HUABAN_WIDGETS .HUABAN-waterfall .HUABAN-empty {position: absolute; left: 50%; top: 30px; height: 36px; line-height: 36px; width: 216px; text-align: left; margin-left: -128px; color: #777; background: url(//huaban.com/img/widgets/icon_notice.png) 12px 8px no-repeat white; padding-left: 40px; font-size: 15px;} #HUABAN_WIDGETS .HUABAN-btn {display: inline-block; border-radius: 2px; font-size: 14px; padding: 0 12px; height: 30px; line-height: 30px; cursor: pointer; text-decoration: none; white-space: nowrap; -moz-user-select: none; -webkit-user-select: none; user-select: none; text-align: center; background: #D53939; color: white;} #HUABAN_WIDGETS .HUABAN-btn:hover {background: #E54646;} #HUABAN_WIDGETS .HUABAN-btn:active {background: #C52424;} #HUABAN_WIDGETS .HUABAN-wbtn {background: #EDEDED; color: #444;} #HUABAN_WIDGETS .HUABAN-wbtn:hover {background: #F2F2F2;} #HUABAN_WIDGETS .HUABAN-wbtn:active {background: #DDD;} #HUABAN_WIDGETS .HUABAN-f-button {position: absolute; display: none; z-index: 9999999999998; box-shadow: 0 0 0 2px rgba(255,255,255,.2); background: #aaa; background: rgba(0,0,0,.3); color: white; cursor: pointer; padding: 0 12px; height: 30px; line-height: 30px; border-radius: 2px; font-size: 14px} #HUABAN_WIDGETS .HUABAN-f-button:hover {background-color: #999; background-color: rgba(0,0,0,.5);} #HUABAN_WIDGETS .HUABAN-f-button:active {background-color: rgba(0,0,0,.6);} #HUABAN_WIDGETS .HUABAN-red-normal-icon-button {width: 36px; height: 24px; border: 0px; line-height: 24px; padding-left: 24px; padding-right: 0px; text-align: left; background: url(//huaban.com/img/widgets/widget_icons.png) 0 -200px no-repeat; box-shadow: none !important; font-size: 14px; background-color: transparent !important;} #HUABAN_WIDGETS .HUABAN-red-normal-icon-button:hover {background-position: -130px -200px;} #HUABAN_WIDGETS .HUABAN-red-normal-icon-button:active {background-position: -260px -200px;} #HUABAN_WIDGETS .HUABAN-red-large-icon-button {width: 80px; height: 24px; border: 0px; line-height: 24px; padding-left: 24px; padding-right: 0px; text-align: left; background: url(//huaban.com/img/widgets/widget_icons.png) 0 -150px no-repeat; box-shadow: none !important; font-size: 14px; background-color: transparent !important;} #HUABAN_WIDGETS .HUABAN-red-large-icon-button:hover {background-position: -130px -150px;} #HUABAN_WIDGETS .HUABAN-red-large-icon-button:active {background-position: -260px -150px;} #HUABAN_WIDGETS .HUABAN-red-small-icon-button {width: 30px; height: 21px; border: 0px; line-height: 21px; padding-left: 20px; padding-right: 0px; text-align: left; background: url(//huaban.com/img/widgets/widget_icons.png) 0 -250px no-repeat; box-shadow: none !important; font-size: 12px; background-color: transparent !important;} #HUABAN_WIDGETS .HUABAN-red-small-icon-button:hover {background-position: -130px -250px;} #HUABAN_WIDGETS .HUABAN-red-small-icon-button:active {background-position: -260px -250px;} #HUABAN_WIDGETS .HUABAN-white-normal-icon-button {width: 36px; height: 24px; border: 0px; line-height: 24px; padding-left: 24px; padding-right: 0px; text-align: left; background: url(//huaban.com/img/widgets/widget_icons.png) 0 -500px no-repeat; box-shadow: none !important; color: #444; font-size: 14px; background-color: transparent !important;} #HUABAN_WIDGETS .HUABAN-white-normal-icon-button:hover {background-position: -130px -500px;} #HUABAN_WIDGETS .HUABAN-white-normal-icon-button:active {background-position: -260px -500px;} #HUABAN_WIDGETS .HUABAN-white-large-icon-button {width: 80px; height: 24px; border: 0px; line-height: 24px; padding-left: 24px; padding-right: 0px; text-align: left; background: url(//huaban.com/img/widgets/widget_icons.png) 0 -450px no-repeat; box-shadow: none !important; color: #444; font-size: 14px; background-color: transparent !important;} #HUABAN_WIDGETS .HUABAN-white-large-icon-button:hover {background-position: -130px -450px;} #HUABAN_WIDGETS .HUABAN-white-large-icon-button:active {background-position: -260px -450px;} #HUABAN_WIDGETS .HUABAN-white-small-icon-button {width: 30px; height: 21px; border: 0px; line-height: 21px; padding-left: 20px; padding-right: 0px; text-align: left; background: url(//huaban.com/img/widgets/widget_icons.png) 0 -550px no-repeat; box-shadow: none !important; color: #444; font-size: 12px; background-color: transparent !important;} #HUABAN_WIDGETS .HUABAN-white-small-icon-button:hover {background-position: -130px -550px;} #HUABAN_WIDGETS .HUABAN-white-small-icon-button:active {background-position: -260px -550px;} #HUABAN_WIDGETS .HUABAN-cell {width: 236px; position: absolute; background: white; box-shadow: 0 1px 3px rgba(0,0,0,.3); transition: left .3s ease-in-out, top .3s linear;} #HUABAN_WIDGETS .HUABAN-cell .HUABAN-img-holder {overflow: hidden; position: relative;} #HUABAN_WIDGETS .HUABAN-cell .HUABAN-img-holder:hover img.HUABAN-cell-img {opacity: .8} #HUABAN_WIDGETS .HUABAN-cell .HUABAN-video-icon {width: 72px; height: 62px; position: absolute; left: 50%; top: 50%; margin: -31px auto auto -36px; background: url(//huaban.com/img/widgets/media_video.png) 0 0 no-repeat; display: none;} #HUABAN_WIDGETS .HUABAN-cell.HUABAN-video .HUABAN-video-icon {display: block;} #HUABAN_WIDGETS .HUABAN-cell .HUABAN-over {display: none;} #HUABAN_WIDGETS .HUABAN-cell:hover .HUABAN-over {display: block;} #HUABAN_WIDGETS .HUABAN-cell .HUABAN-over .HUABAN-btn {width: 60px; height: 34px; padding: 0; position: absolute; left: 50%; top: 50%; margin: -18px 0 0 -31px; line-height: 34px; box-shadow: 0 0 0 2px rgba(255,255,255,.2); font-size: 16px;} #HUABAN_WIDGETS .HUABAN-cell.HUABAN-long .HUABAN-img-holder {height: 600px;} #HUABAN_WIDGETS .HUABAN-cell.HUABAN-long .HUABAN-img-holder:after {content: ""; display: block; position: absolute; width: 236px; height: 12px; left: 0; bottom: 0; background: url(//huaban.com/img/widgets/long_image_shadow_2.png) repeat-x 4px top;} #HUABAN_WIDGETS .HUABAN-cell img {width: 236px; display: block;} #HUABAN_WIDGETS .HUABAN-cell .HUABAN-size {margin: 8px 16px; font-size: 12px; color: #999} #HUABAN_WIDGETS .HUABAN-cell .HUABAN-description {display: block; margin: 0 6px 6px; padding: 6px 10px; border: 0; resize: none; outline: 0; border: 1px solid transparent; line-height: 18px; font-size: 13px; overflow: hidden; word-wrap: break-word; background: url(//huaban.com/img/widgets/icon_edit.png) 500px center no-repeat;} #HUABAN_WIDGETS .HUABAN-cell:hover .HUABAN-description {background-color: #fff9e0; background-position: 206px center;} #HUABAN_WIDGETS .HUABAN-cell .HUABAN-description:focus {background-color: #F9F9F9; background-position: 500px center;} #HUABAN_WIDGETS .HUABAN-cell .HUABAN-select-btn {width: 34px; height:34px; background: url(//huaban.com/img/widgets/checkbox.png) 0 0 no-repeat; position: absolute; right: 5px; top: 5px; cursor: pointer;} #HUABAN_WIDGETS .HUABAN-cell .HUABAN-pinned-label {position: absolute; left: 0; top: 10px; height: 24px; line-height: 24px; padding: 0 10px; background: #CE0000; background: rgba(200, 0, 0, 0.9); color: white; font-size: 12px; display: none;} #HUABAN_WIDGETS .HUABAN-cell.HUABAN-pinned .HUABAN-pinned-label {display: block;} #HUABAN_WIDGETS .HUABAN-selected .HUABAN-select-btn {background-position: 0 -40px;} #HUABAN_WIDGETS .HUABAN-multi .HUABAN-cell .HUABAN-img-holder {cursor: pointer;} #HUABAN_WIDGETS .HUABAN-multi .HUABAN-cell .HUABAN-cell-pin-btn {display: none;} #HUABAN_WIDGETS .HUABAN-multi .HUABAN-cell .HUABAN-over {display: block;} #HUABAN_WIDGETS .HUABAN-header .HUABAN-multi-buttons {position: absolute; top: 10px; left: 0; display: none;} #HUABAN_WIDGETS .HUABAN-header .HUABAN-multi-buttons .HUABAN-btn {margin-right: 10px;} #HUABAN_WIDGETS .HUABAN-header .HUABAN-multi-noti {display: none; height: 50px; line-height: 50px; text-align: center; font-size: 16px; color: #999; font-weight: bold;} #HUABAN_WIDGETS .HUABAN-header .HUABAN-multi-noti span {font-weight: normal;} #HUABAN_WIDGETS .HUABAN-header .HUABAN-multi-noti i {font-style: normal;} #HUABAN_WIDGETS .HUABAN-header .HUABAN-notice {padding: 0 10px; height:30px; line-height: 30px; position: absolute; left: 50%; top: 10px; margin-left: -83px; background: #fff9e2; text-align: center;} #HUABAN_WIDGETS .HUABAN-header .HUABAN-notice i {display: inline-block; width: 18px; height: 18px; background: url(//huaban.com/img/widgets/icon_notice.png) 0 0 no-repeat; vertical-align: top; margin: 6px 6px 0 0;} #HUABAN_WIDGETS .HUABAN-switcher {height: 50px; width: 100px; position: relative;} #HUABAN_WIDGETS .HUABAN-switcher .HUABAN-title {position: absolute; right: 75px; top: 13px; color: #999; white-space: nowrap; line-height: 24px; opacity: 0; visibility: hidden;} #HUABAN_WIDGETS .HUABAN-switcher:hover .HUABAN-title {visibility: visible; opacity: 1; -webkit-transition: opacity .2s linear; -webkit-transition-delay: .2s; transition: opacity .2s linear; transition-delay: .2s;} #HUABAN_WIDGETS .HUABAN-switcher .HUABAN-bar {width: 40px; height: 24px; background: #EB595F; border-radius: 12px; color: white; position: absolute; right: 0; top: 13px; cursor: pointer; font-size: 14px; -webkit-transition: all .2s linear; transition: all .2s linear;} #HUABAN_WIDGETS .HUABAN-switcher:hover .HUABAN-bar {width: 64px;} #HUABAN_WIDGETS .HUABAN-switcher.HUABAN-on .HUABAN-bar {background: #7DD100;} #HUABAN_WIDGETS .HUABAN-switcher .HUABAN-bar .HUABAN-round {width: 20px; height: 20px; background: white; border-radius: 50%; position: absolute; left: 2px; top: 2px; -webkit-transition: left .2s linear; box-shadow: 0px 0px 3px rgba(0,0,0,0.15); transition: left .2s linear; box-shadow: 0px 0px 3px rgba(0,0,0,0.15);} #HUABAN_WIDGETS .HUABAN-switcher.HUABAN-on .HUABAN-bar .HUABAN-round {left: 17px;} #HUABAN_WIDGETS .HUABAN-switcher.HUABAN-on:hover .HUABAN-bar .HUABAN-round {left: 41px;} #HUABAN_WIDGETS .HUABAN-switcher .HUABAN-bar .HUABAN-text-1 {height: 24px; line-height: 24px; position: absolute; right:17px; top: 0; opacity: 0; visibility: hidden; -webkit-transition: all .2s linear; transition: all .2s linear;} #HUABAN_WIDGETS .HUABAN-switcher:hover .HUABAN-bar .HUABAN-text-1 {right: 9px; opacity: 1; visibility: visible;} #HUABAN_WIDGETS .HUABAN-switcher.HUABAN-on:hover .HUABAN-bar .HUABAN-text-1 {right: 17px; opacity: 0; visibility: hidden;} #HUABAN_WIDGETS .HUABAN-switcher .HUABAN-bar .HUABAN-text-2 {height: 24px; line-height: 24px; position: absolute; left:17px; top: 0; opacity: 0; visibility: hidden; -webkit-transition: all .2s linear; transition: all .2s linear;} #HUABAN_WIDGETS .HUABAN-switcher:hover .HUABAN-bar .HUABAN-text-2 {left: 17px; opacity: 0; visibility: hidden;} #HUABAN_WIDGETS .HUABAN-switcher.HUABAN-on:hover .HUABAN-bar .HUABAN-text-2 {left: 9px; opacity: 1; visibility: visible;} #HUABAN_WIDGETS .HUABAN-header .HUABAN-switcher {position: absolute; right: 0; top: 0;} <!--[if IE 6]>#HUABAN_WIDGETS .HUABAN-red-normal-icon-button, .HUABAN-red-large-icon-button, .HUABAN-red-small-icon-button, .HUABAN-white-normal-icon-button, .HUABAN-white-large-icon-button, .HUABAN-white-small-icon-button { background-image: url({{imgBase}}/widget_icons_ie6.png) <![endif]--></style></div></body></html>