9512 OrzOyy
时间限制:1000MS  内存限制:65535K
提交次数:146 通过次数:8 

题型: 编程题   语言: 无限制



Description
    作为一名新生，如果你有兴趣进入SCAU ACM/ICPC队，以下这个人是你必须认识的。

    OYY， 人称欧教主，又名欧阳阳，乃SCAU ACM队06级领军人物，竞赛生涯获奖无数，区域赛两金两银至今SCAU无人能出其右。
    其人性格开朗，为人忽悠，供职于国内某著名网游公司，收入丰厚，独居无偶。
    由于OYY的辉煌战绩，即使在其退役之后仍然是SCAU最受膜拜的ACM队员（更重要的原因在于可以吸收他的RP）。
    鉴于膜拜他的人数众多，OYY需要对所有膜拜他的人收取月费，以进行各种补充RP的活动。
    OYY的工作实在太忙了，他不能每个月亲自收取月费，所以他需要你为他建立一个月费收取系统来帮助。

    首先对该系统一些运行状况作出定义： 
    1.	用户状态：每个用户在加入膜拜OYY的行列时，需要预先缴交一笔款项，作为以后扣取月费之用；
        当一个用户加入并交费之后，其状态为变为“Active”；
        如果经过一段时间，该用户主动退出膜拜行列（当然这种行为会受到BS并大幅度降低RP），其状态变为“Manual Quit”；
        如果用户预缴的款项已经不足以缴交月费，将会被强制退出，状态变为“Force Quit”。
    2.	会计日：每个月的7 / 14 / 21 / 28日为会计日，所有费用记录到了这些时间才会进行处理。
    3.	扣费日：每个月最后一个会计日前（27日），系统会自动向所有状态为“Active”的用户扣取月费。
    4.	扣取费用：每个月月费定额为30元，计费周期为上一个月扣费日之后的一天到本个扣费日为止。
        假如本月为6月，则计费周期为5.28 ―― 6.27。对于加入不足一个月的用户，则按比例收取：
        1)    用户加入后的翌日为第一个计费日。假如用户在6月5日加入，则其在本次计费周期内的计费时段为6.6 ―― 6.27（共22日），所以在6月27日应收取22 / 31 * 30 元。
        2)    如果一个用户选择主动退出，状态马上转为“Manual Quit”，但作为惩罚，系统会继续收取费用直到会计日的处理为止。
              若该段时间跨过了扣费日，则应当分开按比例计算两部分费用。
              假如用户在6月1日退出，则计费时段为5.28 ―― 6.7（共11日），所以将在6月7日收取11 / 31 * 30元，如果仍有余额，则全部返还给用户。
              而如果用户在在2月22日退出，则计费时段为1.28-2.28（假设在1.27之前加入），跨过2.27，故收取费用分两个计费周期，为31/31*30 + 1/28*30元。
        3)    当用户剩余的预缴款项不足以缴交当次月费（无论是Active还是Manual Quit状态），则会将剩余的费用全部扣除，并将其状态转为“Force Quit”。
    根据OYY需要的月费系统有以下需求：
    1.	每月扣费日，输出所有扣费前状态为“Active”的用户姓名、实际被扣取的费用
    2.	每个会计日，输出所有缴费前状态为“Manual Quit”且在当天需要继续缴费的用户姓名、实际被扣取的费用
    3.	接受OYY随时的查询，根据查询的日期和用户姓名，输出其状态和剩余的预缴款项（如果大于等于0的话）




输入格式
    第一行一个数字n(n<1000)，表示将要输入的记录行数
    之后每一条记录，先以“YYYY MM DD”的格式输入一个日期，表示进行处理的日期，之后根据不同情况，有以下几种命令：
    1.	IN user_name num1，表示姓名为user_name的用户在当天加入，并预缴num1的费用（输入保证所有用户姓名均唯一）；
    2.	OUT user_name，表示姓名为user_name的用户在当天退出（输入保证该用户状态为“Active”）；
    3.	DEBIT，表示当日需要对扣费前状态为“Active”的用户扣取月费（输入保证DEBIT发生的日期必定为每月27日，每个月有且只有一次）；
    4.	ACCT，表示当天为会计日，需要对状态在上一会计日后转为“Manual Quit”的用户扣取月费（输入保证ACCT必定保证每个会计日有且只有一次）；
    5.	QUERY user_name，表示OYY对姓名为user_name的用户进行查询（输入保证该用户正在或曾经加入）。
    保证输入的时间不会出现逆序，时间区间在2010 / 01 / 01 到2010 / 12 / 31之间，DEBIT和ACCT命令必定是在当天最后一个命令。
        PS：记录之间可能会有空行，所以建议使用scanf读入数据。



输出格式
    对于DEBIT命令，输出所有扣费前状态为“Active”的用户姓名、实际被扣取的费用，格式为:
    user_name num2
    表示对姓名为user_name的用户在当天扣取num2元，输出按user_name用户加入时间升序排序

    对于ACCT命令，输出所有状态为“Manual Quit”且在当天需要继续缴费的用户姓名、实际被扣取的费用，输出按user_name用户退出时间升序排序

    对于QUERY命令，
    如果用户状态为“Active”，输出：
    “user_name is Active, the balance is num3.”
    如果状态为“Manual Quit”，输出：
    “user_name has perform Manual Quit.”
    如果状态为“Force Quit”，输出：
    “user_name has been performed Force Quit.”

    每组数据输出之后加一个空行，若当前命令无输出，则不需输出空行。




输入样例
23
2010 01 05 IN user1 100
2010 01 07 ACCT
2010 01 14 ACCT
2010 01 21 ACCT
2010 01 23 IN user2 50
2010 01 27 DEBIT
2010 01 28 ACCT
2010 02 01 OUT user1
2010 02 07 ACCT
2010 02 14 ACCT
2010 02 16 Query user1
2010 02 16 Query user2
2010 02 21 ACCT
2010 02 27 DEBIT
2010 02 28 ACCT
2010 03 01 OUT user2
2010 03 07 ACCT
2010 03 10 Query user1
2010 03 14 ACCT
2010 03 21 ACCT
2010 03 27 DEBIT
2010 03 28 ACCT
2010 03 30 Query user2




输出样例
user1 21.29
user2 3.87

user1 10.65

user1 has perform Manual Quit.

user2 is Active, the balance is 46.13.

user2 30.00

user2 8.57

user1 has perform Manual Quit.

user2 has perform Manual Quit.





提示
SP THX To Sirius.

