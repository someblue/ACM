10687 东方迷m
该题有题解

时间限制:1000MS  内存限制:65535K
提交次数:0 通过次数:0 

题型: 编程题   语言: 无限制



Description
    moezen喜欢玩同人游戏，这次他正在玩Touhou project的二次同人游戏《|方の迷m》，这个游戏是仿制自NDS著名游戏《世界树迷宫》，是一个迷宫闯关型的RPG游戏，由于是仿
制《世界树迷宫》的游戏，所以它继承了《世界树迷宫》那地狱般的难度和极其变态的迷宫，这是一个迷宫让你走到吐血到找不到出口，路边小怪都能让你灭团，BOSS拥有开场全场秒
杀技能的超级变态的游戏，以至于moezen玩到一半就已经心力憔悴。

    于是，他找来了攻略，找到了每一层迷宫的地图，例如下图。

 

    由于这游戏的小怪太变态了，RP不好随时都会灭团，所以，为了安全起见，moezen每次都会尽可能找最短的路径到达下一层的楼梯。而在每个迷宫里都有许多宝箱，里面有价值不
同的装备，为了能让战斗变得更轻松，所以他希望能在保证安全的情况下得到价值总量尽可能大的装备。

    现在moezen到达了新的楼层，通过观察地图，他发现了这层迷宫有这样的规律：
    一、	这是一个n*n个方格构成的迷宫。
    二、	迷宫的起点在左上角，终点在右下角。
    三、	在迷宫中，方格与方格间可能存在挡板，如果相邻的两个方格间存在挡板，则不能从其中一个方格到达另一个方格，否则可以通过。
    四、	迷宫中的挡板不会出现相连的情况。

    同样，moezen希望在这一层迷宫中以最短的路径到达终点的同时取得价值总量最大的装备，但是由于这个游戏，他已经变得精神恍惚了，所以希望各位ACMer能帮他解决这个问题。




输入格式
    第一行输入一个整数T(T<=20)，表示case数。
    对于每个case，第一行为一个整数n(1<n<100)，表示一个大小为n*n迷宫，接下来有n行，每行有n个整数Xij(0<=Xij<=9)，表示迷宫中的宝箱的价值。
    接下来为一个整数m(0<=m<1000)，表示迷宫中的挡板数，接下来的m行有4个整数，x1,y1,x2,y2(0<=x1,y1,x2,y2<n)，表示第x1行第y1个方格与第x2行与第y2个方格之间存在一块
挡板(两个方格相邻)。



输出格式
    先输出第i个case，再输出一个整数，表示到达终点后取得的装备的最大价值。



输入样例
2
5
05000
02000
00010
00500
00001
0

5
20002
01000
13000
50211
00051
1
4 4 4 3




输出样例
Case 1: 13
Case 2: 13

